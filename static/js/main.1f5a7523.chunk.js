(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{143:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},176:function(e,t,n){e.exports=n(309)},300:function(e,t,n){},309:function(e,t,n){"use strict";n.r(t);n(177),n(201);var a=n(0),r=n.n(a),s=n(61),o=n.n(s),i=n(21),l=n(22),c=n(148),u=n(43),m=n(7),d=function(e){return{PENDING:"".concat(e,"_PENDING"),SUCCESS:"".concat(e,"_SUCCESS"),ERROR:"".concat(e,"_ERROR")}},p=d("GET_POSTS"),g=d("GET_POSTS_CONTENTS"),f={posts:[],postInfo:null,isPendingPosts:!1,isPendingContentsPostInfo:!1,error:""},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case p.PENDING:return Object(m.a)({},e,{posts:t.replaceFeed?[]:e.posts,error:"",isPendingPosts:!0});case p.SUCCESS:return Object(m.a)({},e,{posts:t.replaceFeed?t.payload:[].concat(Object(u.a)(e.posts),Object(u.a)(t.payload)),error:"",isPendingPosts:!1});case p.ERROR:return Object(m.a)({},e,{posts:[],error:t.payload,isPendingPosts:!1});case g.PENDING:return Object(m.a)({},e,{error:"",isPendingContentsPostInfo:!0});case g.SUCCESS:return Object(m.a)({},e,{postInfo:t.payload,error:"",isPendingContentsPostInfo:!1});case g.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingContentsPostInfo:!1});default:return e}},v=d("SEARCH_POSTS"),b=d("SEARCH_USERS"),y=d("SEARCH_TAGS"),E={posts:[],users:[],tags:[],isPendingPosts:!1,isPendingUsers:!1,isPendingTags:!1,keyword:"",error:""},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case v.PENDING:return Object(m.a)({},e,{posts:[],error:"",isPendingPosts:!0});case v.SUCCESS:return Object(m.a)({},e,{posts:t.payload,keyword:t.keyword,error:"",isPendingPosts:!1});case v.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingPosts:!1});case b.PENDING:return Object(m.a)({},e,{error:"",isPendingUsers:!0});case b.SUCCESS:return Object(m.a)({},e,{users:t.payload,keyword:t.keyword,error:"",isPendingUsers:!1});case b.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingUsers:!1});case y.PENDING:return Object(m.a)({},e,{error:"",isPendingTags:!0});case y.SUCCESS:return Object(m.a)({},e,{tags:t.payload,keyword:t.keyword,error:"",isPendingTags:!1});case y.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingTags:!1});default:return e}},I=d("GET_USER_INFO"),P=d("GET_USER_POSTS"),S=d("GET_FOLLOWERS"),w=d("GET_FOLLOWING"),C=d("GET_PAID_USERS"),O=(d("FOLLOW"),d("UNFOLLOW"),{user:null,posts:[],followers:[],following:[],paidUsers:[],isPendingUser:!1,isPendingPosts:!1,isPendingFollowers:!1,isPendingFollowing:!1,isPendingPaidUsers:!1,error:""}),$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case I.PENDING:return Object(m.a)({},e,{user:{},error:"",isPendingUser:!0});case I.SUCCESS:return Object(m.a)({},e,{user:t.payload,error:"",isPendingUser:!1});case I.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingUser:!1});case P.PENDING:return Object(m.a)({},e,{posts:[],error:"",isPendingPosts:!0});case P.SUCCESS:return Object(m.a)({},e,{posts:t.payload,error:"",isPendingPosts:!1});case P.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingPosts:!1});case S.PENDING:return Object(m.a)({},e,{error:"",isPendingFollowers:!0});case S.SUCCESS:return Object(m.a)({},e,{followers:t.payload,error:"",isPendingFollowers:!1});case S.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingFollowers:!1});case w.PENDING:return Object(m.a)({},e,{error:"",isPendingFollowing:!0});case w.SUCCESS:return Object(m.a)({},e,{following:t.payload,error:"",isPendingFollowing:!1});case w.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingFollowing:!1});case C.PENDING:return Object(m.a)({},e,{error:"",isPendingPaidUsers:!0});case C.SUCCESS:return Object(m.a)({},e,{paidUsers:t.payload,error:"",isPendingPaidUsers:!1});case C.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingPaidUsers:!1});default:return e}},T=d("GET_CONTESTS"),j=d("GET_CONTEST_INFO"),_=d("GET_CONTEST_POSTS"),U={contestInfo:null,contests:[],isPendingContest:!1,isPendingContests:!1,isPendingContestPosts:!1,error:""},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case T.PENDING:return Object(m.a)({},e,{contests:[],error:"",isPendingContests:!0});case T.SUCCESS:return Object(m.a)({},e,{contests:t.payload,error:"",isPendingContests:!1});case T.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingContests:!1});case j.PENDING:return Object(m.a)({},e,{contestInfo:{},error:"",isPendingContest:!0});case j.SUCCESS:return console.log("action:",t),Object(m.a)({},e,{contestInfo:t.payload,error:"",isPendingContest:!1});case j.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingContest:!1});case _.PENDING:return Object(m.a)({},e,{contestPosts:[],error:"",isPendingContestPosts:!0});case _.SUCCESS:return console.log("action:",t),Object(m.a)({},e,{contestPosts:t.payload,error:"",isPendingContestPosts:!1});case _.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingContestPosts:!1});default:return e}},R=d("GET_COMMENTS"),D=d("CREATE_COMMENT"),F=d("UPDATE_COMMENT"),L=d("DELETE_COMMENT"),x={comments:[],isPendingComments:!1,error:""},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case R.PENDING:return Object(m.a)({},e,{comments:[],error:"",isPendingComments:!0});case R.SUCCESS:return Object(m.a)({},e,{comments:[].concat(Object(u.a)(t.payload),Object(u.a)(e.comments)),error:"",isPendingComments:!1});case R.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingComments:!1});case D.PENDING:return Object(m.a)({},e,{error:""});case D.SUCCESS:return Object(m.a)({},e,{comments:[].concat(Object(u.a)(t.payload),Object(u.a)(e.comments)),error:""});case D.ERROR:return Object(m.a)({},e,{error:t.payload});case F.PENDING:return Object(m.a)({},e,{error:""});case F.SUCCESS:return Object(m.a)({},e,{comments:t.payload,error:""});case F.ERROR:return Object(m.a)({},e,{error:t.payload});case L.PENDING:return Object(m.a)({},e,{error:""});case L.SUCCESS:return Object(m.a)({},e,{comments:t.payload,error:""});case L.ERROR:return Object(m.a)({},e,{error:t.payload});default:return e}},A=Object(i.c)({posts:h,search:k,users:$,contests:N,comments:M}),G=function(e,t){return A(e,t)};function B(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var q=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var V=n(12),z=n(13),W=n(15),H=n(14),Y=n(16),J=n(63),K=n.n(J),Q=n(2),X=function(){function e(){Object(V.a)(this,e)}return Object(z.a)(e,null,[{key:"setItem",value:function(e,t){sessionStorage.setItem(e,JSON.stringify(t))}},{key:"getItem",value:function(e){return sessionStorage.getItem(e)}},{key:"clear",value:function(){sessionStorage.clear()}}]),e}(),Z=(n(211),n(124)),ee=n.n(Z),te=n(125),ne=n.n(te),ae=n(149),re=n.n(ae),se=n(150),oe=n.n(se),ie=(n(213),n(151)),le=n.n(ie),ce=(n(214),n(175)),ue=n(219),me=n(17),de=(n(220),n(315)),pe=n(174),ge=n(221),fe=n.n(ge),he=new de.a({dataIdFromObject:function(e){return e.__typename&&void 0!==e.id?"".concat(e.__typename,":").concat(e.id):null},addTypename:!0,cacheRedirects:{Query:{}}}),ve=Object(ue.a)().concat(new ce.a({uri:"https://ryfma.com/graphql"})),be=new me.ApolloLink(function(e,t){var n=fe.a.getLoginToken();return e.setContext({headers:{"meteor-login-token":n},http:{includeExtensions:!0,includeQuery:!1}}),t(e)}).concat(ve),ye=(console.log,new pe.a({link:me.ApolloLink.from([].concat([be])),cache:he})),Ee=n(10),ke=n(8),Ie=n.n(ke);function Pe(){var e=Object(Ee.a)(["\n  mutation updatePost(\n    $_id: ID!,\n    $title: String!,\n    $slug: String!,\n    $htmlBody:  String!,\n    $excerpt: String!,\n    $paymentType: Int,\n    $coins: Int,\n    $status: String!,\n    $sticky: Boolean,\n    $coverImg: String,\n    $videoLink: String,\n    $tags: [String]!,\n    $albumId: String,\n    $oldAlbumId: String,\n    $isFromRyfmaBlog: Boolean\n    $isAdultContent: Boolean\n    $isCertified: Boolean\n  ) {\n    updatePost(\n      _id: $_id,\n      title: $title,\n      slug: $slug,\n      htmlBody: $htmlBody,\n      excerpt: $excerpt,\n      paymentType: $paymentType,\n      coins: $coins,\n      status: $status,\n      sticky: $sticky,\n      coverImg: $coverImg,\n      videoLink: $videoLink,\n      tags: $tags,\n      albumId: $albumId,\n      oldAlbumId: $oldAlbumId,\n      isFromRyfmaBlog: $isFromRyfmaBlog,\n      isCertified: $isCertified,\n      isAdultContent: $isAdultContent\n    )\n  }\n"]);return Pe=function(){return e},e}function Se(){var e=Object(Ee.a)(["\n  mutation deletePost($_id: ID!) {\n    deletePost(\n      _id: $_id\n    )\n  }\n"]);return Se=function(){return e},e}function we(){var e=Object(Ee.a)(["\n  mutation insertPost(\n    $title: String!,\n    $slug: String!,\n    $htmlBody:  String!,\n    $excerpt: String!,\n    $paymentType: Int,\n    $coins: Int,\n    $status: String!,\n    $sticky: Boolean,\n    $coverImg: String,\n    $videoLink: String,\n    $tags: [String]!,\n    $albumId: String,\n    $isFromRyfmaBlog: Boolean\n    $isCertified: Boolean\n    $isAdultContent: Boolean\n  ) {\n    insertPost(\n      title: $title,\n      slug: $slug,\n      htmlBody: $htmlBody,\n      paymentType: $paymentType,\n      coins: $coins,\n      excerpt: $excerpt,\n      status: $status,\n      sticky: $sticky,\n      coverImg: $coverImg,\n      videoLink: $videoLink,\n      tags: $tags,\n      albumId: $albumId,\n      isFromRyfmaBlog: $isFromRyfmaBlog,\n      isCertified: $isCertified,\n      isAdultContent: $isAdultContent\n    ){\n      _id\n    }\n  }\n"]);return we=function(){return e},e}function Ce(){var e=Object(Ee.a)(["\n  query getPostLikers($postId: ID!, $festId: String, $skip: Int, $limit: Int) {\n    getPostLikers(postId: $postId, festId: $festId, skip: $skip, limit: $limit)\n  }\n"]);return Ce=function(){return e},e}function Oe(){var e=Object(Ee.a)(["\n  query getRelatedPosts($postId: ID!, $tags: [String]) {\n    relatedPosts(postId: $postId, tags: $tags) {\n      _id\n      createdAt\n      postedAt\n      title\n      coverImg\n      slug\n      excerpt\n      tags {\n        _id\n        name\n        slug\n      }\n      author {\n        _id\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return Oe=function(){return e},e}function $e(){var e=Object(Ee.a)(["\n  mutation followUser($_id: ID!) {\n    followUser(\n      _id: $_id\n    )\n  }\n"]);return $e=function(){return e},e}function Te(){var e=Object(Ee.a)(["\n  mutation allowAdultContent {\n    allowAdultContent\n  }\n"]);return Te=function(){return e},e}function je(){var e=Object(Ee.a)(["\n  mutation increasePostViewCount($_id: ID!) {\n    increasePostViewCount(_id: $_id)\n  }\n"]);return je=function(){return e},e}function _e(){var e=Object(Ee.a)(["\n  mutation savePost($_id: ID!, $title: String!, $userId: String!) {\n    savePost(_id: $_id, title: $title, userId: $userId)\n  }\n"]);return _e=function(){return e},e}function Ue(){var e=Object(Ee.a)(["\n  mutation unSavePost($_id: ID!, $userId: String!) {\n    unSavePost(_id: $_id, userId: $userId)\n  }\n"]);return Ue=function(){return e},e}function Ne(){var e=Object(Ee.a)(["\n  mutation likePost(\n    $_id: ID!\n    $title: String!\n    $userId: String!\n    $likes: Int!\n    $totalLikes: Int!\n  ) {\n    likePost(\n      _id: $_id\n      title: $title\n      userId: $userId\n      likes: $likes\n      totalLikes: $totalLikes\n    )\n  }\n"]);return Ne=function(){return e},e}function Re(){var e=Object(Ee.a)(["\n  query getPromotion {\n    getPromotion {\n      _id\n      totalViews\n      currentViews\n      post {\n        _id\n        createdAt\n        postedAt\n        title\n        slug\n        excerpt\n        coverImg\n        videoLink\n        author {\n          _id\n          username\n          roles\n          isFollowing\n          emails {\n            verified\n          }\n          profile {\n            name\n            image\n          }\n        }\n      }\n    }\n  }\n"]);return Re=function(){return e},e}function De(){var e=Object(Ee.a)(["\n  query getPostInfo($postId: ID!) {\n    getPost(postId: $postId) {\n      _id\n      createdAt\n      postedAt\n      title\n      slug\n      excerpt\n      htmlBody\n      likeCount\n      liked\n      currUserLikes\n      viewCount\n      savedCount\n      saved\n      commentsCount\n      userId\n      coverImg\n      videoLink\n      fests\n      paymentType\n      coins\n      isBought\n      isCertified\n      isAdultContent\n      album {\n        _id\n        title\n        slug\n      }\n      tags {\n        _id\n        name\n        slug\n      }\n      author {\n        _id\n        username\n        isFollowing\n        coins\n        roles\n        emails {\n          verified\n        }\n        profile {\n          name\n          image\n          twitterUser\n        }\n      }\n    }\n  }\n"]);return De=function(){return e},e}function Fe(){var e=Object(Ee.a)(["\n  query getPostData($postId: ID!) {\n    getPost(postId: $postId) {\n      _id\n      postedAt\n      title\n      slug\n      htmlBody\n      excerpt\n      paymentType\n      coins\n      viewCount\n      lastCommentedAt\n      clickCount\n      status\n      sticky\n      userId\n      coverImg\n      videoLink\n      videoId\n      tags {\n        _id\n        name\n      }\n      fests\n      albumId\n      isCertified\n      isAdultContent\n      isFromRyfmaBlog\n    }\n  }\n"]);return Fe=function(){return e},e}function Le(){var e=Object(Ee.a)(["\nquery getLatestPosts($type: String, $userId: String, $albumId: String, $tagId: String, $festId: String, $duration: String, $withImage: Boolean, $personal: Boolean, $keyword: String, $skip: Int, $limit: Int) {\n  posts(type: $type, userId: $userId, albumId: $albumId, tagId: $tagId, festId: $festId, duration: $duration, withImage: $withImage, personal: $personal, keyword: $keyword, skip: $skip, limit: $limit) {\n    _id\n    createdAt\n    postedAt\n    title\n    slug\n    excerpt\n    coverImg\n    videoLink\n    isAdultContent\n    paymentType\n    coins\n    isBought\n    isPromoted\n    isFromRyfmaBlog\n    promo {\n      currentViews\n    }\n    author {\n      _id\n      username\n      roles\n      isFollowing\n      emails {\n        verified\n      }\n      profile {\n        name\n        image\n      }\n    }\n  }\n}\n"]);return Le=function(){return e},e}var xe=Ie()(Le()),Me=(Ie()(Fe()),Ie()(De())),Ae=(Ie()(Re()),Ie()(Ne()),Ie()(Ue()),Ie()(_e()),Ie()(je()),Ie()(Te()),Ie()($e()),Ie()(Oe()),Ie()(Ce()),Ie()(we()),Ie()(Se()),Ie()(Pe()),function(e){var t=e.type,n=e.userId,a=e.albumId,r=e.tagId,s=e.festId,o=e.withImage,i=e.duration,l=e.personal,c=e.keyword,u=e.skip,m=e.limit,d=e.force,g=e.replaceFeed;return function(e,f){return console.log("New action!"),console.log("replaceFeed: ",g),e({type:p.PENDING,replaceFeed:g}),ye.query({query:xe,variables:{type:t,userId:n,albumId:a,tagId:r,festId:s,withImage:o,duration:i,personal:l,keyword:c,skip:u,limit:m},fetchPolicy:d?"network-only":"cache-first"}).then(function(t){e({type:p.SUCCESS,payload:t.data.posts,replaceFeed:g,error:""})}).catch(function(t){e({type:p.ERROR,payload:t.message})})}}),Ge=function(e){var t=e.postId;return function(e,n){return e({type:g.PENDING}),ye.query({skip:!t,query:Me,variables:{postId:t}}).then(function(t){e({type:g.SUCCESS,payload:t.data.getPost})}).catch(function(t){e({type:g.ERROR,payload:t.message})})}},Be=function(e){function t(){return Object(V.a)(this,t),Object(W.a)(this,Object(H.a)(t).apply(this,arguments))}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"render",value:function(){return r.a.createElement(Q.Spinner,null)}}]),t}(a.Component),qe=(n(143),function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).state={},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"render",value:function(){var e=this.props.post;if(!e.author)return null;var t=e.excerpt;return r.a.createElement(Q.Group,{id:e._id,className:"post-list-item"},r.a.createElement(Q.Cell,{size:"l",description:"\u043e\u0442 "+e.author.profile.name,before:r.a.createElement(Q.Avatar,{size:36,src:e.author.profile.image}),onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},e.title),r.a.createElement(Q.Div,{className:"content",onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},e.coverImg&&r.a.createElement(Q.Avatar,{type:"image",src:e.coverImg,className:"post-image"}),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})),r.a.createElement(Q.Cell,{onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},r.a.createElement(Q.Link,{onClick:this.goToPost},"\u0427\u0438\u0442\u0430\u0442\u044c \u0434\u0430\u043b\u0435\u0435")))}}]),t}(a.Component)),Ve=function(e){e.goToFunc;return r.a.createElement(Q.Group,null,r.a.createElement(Q.Cell,null,"\u041b\u0435\u043d\u0442\u0430 \u043f\u0443\u0441\u0442\u0430"))},ze=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).fetchMorePosts=function(e){var t=e.activeTab,a=e.replaceFeed,r=e.skip;return function(){var e=n.props,s=e.userId,o=e.albumId,i=e.tagId,l=e.festId,c=e.withImage,u=e.duration,m=e.personal,d=e.keyword,p=e.limit;n.props.getPosts({type:t,userId:s,albumId:o,tagId:i,festId:l,withImage:c,duration:u,personal:m,keyword:d,force:!0,replaceFeed:a,skip:r,limit:p}),t&&n.setState({activeTab:t})}},n.state={posts:[],activeTab:"latest",lastType:e.type,duration:e.duration},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),console.log("props: ",this.props);var e=this.props,t=e.type,n=e.userId,a=e.albumId,r=e.tagId,s=e.festId,o=e.withImage,i=e.duration,l=e.personal,c=e.keyword,u=e.skip,m=e.limit,d=e.force,p=e.replaceFeed;this.props.getPosts({type:t,userId:n,albumId:a,tagId:r,festId:s,withImage:o,duration:i,personal:l,keyword:c,skip:u,limit:m,force:d,replaceFeed:p})}},{key:"render",value:function(){var e=this,t=this.props,n=t.posts,a=t.isPendingPosts,s=t.type,o=t.userId,i=t.personal,l=r.a.createElement(Q.Group,null,r.a.createElement(Q.Tabs,{type:"buttons"},r.a.createElement(Q.HorizontalScroll,null,r.a.createElement(Q.TabsItem,{onClick:this.fetchMorePosts({activeTab:"latest",replaceFeed:!0,skip:0}),selected:"latest"===this.state.activeTab},"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435"),r.a.createElement(Q.TabsItem,{onClick:this.fetchMorePosts({activeTab:"popular",replaceFeed:!0,skip:0}),selected:"popular"===this.state.activeTab},"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435"),r.a.createElement(Q.TabsItem,{onClick:this.fetchMorePosts({activeTab:"viewed",replaceFeed:!0,skip:0}),selected:"viewed"===this.state.activeTab},"\u0427\u0438\u0442\u0430\u0435\u043c\u044b\u0435"),r.a.createElement(Q.TabsItem,{onClick:this.fetchMorePosts({activeTab:"commented",replaceFeed:!0,skip:0}),selected:"commented"===this.state.activeTab},"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0435\u043c\u044b\u0435")))),c=r.a.createElement(Q.Tabs,{theme:"light"},r.a.createElement(Q.TabsItem,{onClick:this.fetchMorePosts({activeTab:"day",replaceFeed:!0}),selected:"day"===this.state.activeTab},"\u0417\u0430 \u0434\u0435\u043d\u044c"),r.a.createElement(Q.TabsItem,{onClick:this.fetchMorePosts({activeTab:"week",replaceFeed:!0}),selected:"week"===this.state.activeTab},"\u0417\u0430 \u043d\u0435\u0434\u0435\u043b\u044e"),r.a.createElement(Q.TabsItem,{onClick:this.fetchMorePosts({activeTab:"month",replaceFeed:!0}),selected:"month"===this.state.activeTab},"\u0417\u0430 \u043c\u0435\u0441\u044f\u0446"));return r.a.createElement(Q.Group,null,"popular"===s&&c,o&&i&&l,(!n||0===n.length)&&r.a.createElement(Ve,null),a&&r.a.createElement(Be,null),r.a.createElement(Q.List,null,n.map(function(t){return r.a.createElement(qe,{key:t._id,post:t,go:e.props.go})}),r.a.createElement(Q.Div,null,r.a.createElement(Q.Button,{size:"xl",level:"secondary",onClick:this.fetchMorePosts({activeTab:this.state.activeTab,replaceFeed:!1,skip:this.state.posts.length})},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))}}]),t}(a.Component);var We=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{posts:e.posts.posts,isPendingPosts:e.posts.isPendingPosts}},function(e){return Object(i.b)({getPosts:Ae},e)})(ze);function He(){var e=Object(Ee.a)(["\n  query searchTags($keyword: String!) {\n    searchTags(\n      keyword: $keyword\n    ) {\n      name\n      count\n    }\n  }\n"]);return He=function(){return e},e}function Ye(){var e=Object(Ee.a)(["\n  query searchTags($keyword: String!) {\n    searchTags(\n      keyword: $keyword\n    ) {\n      name\n    }\n  }\n"]);return Ye=function(){return e},e}function Je(){var e=Object(Ee.a)(["\n  query searchUsers($keyword: String!, $limit: Int) {\n    searchUsers(keyword: $keyword, limit: $limit) {\n      _id\n      username\n      isFollowing\n      roles\n      profile {\n        name\n        bio\n        image\n      }\n    }\n  }\n"]);return Je=function(){return e},e}function Ke(){var e=Object(Ee.a)(["\n  query searchUsers($keyword: String!) {\n    searchUsers(keyword: $keyword) {\n      _id\n      username\n      profile {\n        name\n        image\n      }\n    }\n  }\n"]);return Ke=function(){return e},e}function Qe(){var e=Object(Ee.a)(["\n  query searchPosts($keyword: String!, $limit: Int) {\n    searchPosts(keyword: $keyword, limit: $limit) {\n      _id\n      createdAt\n      title\n      slug\n      htmlBody\n      excerpt\n      viewCount\n      lastCommentedAt\n      clickCount\n      status\n      sticky\n      userId\n      coverImg\n      author {\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return Qe=function(){return e},e}function Xe(){var e=Object(Ee.a)(["\n  query searchPosts($keyword: String!) {\n    searchPosts(\n      keyword: $keyword\n    ) {\n      _id\n      title\n      coverImg\n    }\n  }\n"]);return Xe=function(){return e},e}Ie()(Xe());var Ze=Ie()(Qe()),et=(Ie()(Ke()),Ie()(Je()));Ie()(Ye()),Ie()(He());function tt(){var e=Object(Ee.a)(["\n  mutation createPayout($payoutType: Int!, $totalSum: Int!, $status: Int!, $comment: String) {\n    createPayout (\n      payoutType: $payoutType,\n      totalSum: $totalSum,\n      status: $status,\n      comment: $comment\n    )\n  }\n"]);return tt=function(){return e},e}function nt(){var e=Object(Ee.a)(["\n  mutation createDeposit($depositType: Int!, $totalSum: Int!, $status: Int!, $comment: String) {\n    createDeposit (\n      depositType: $depositType,\n      totalSum: $totalSum,\n      status: $status,\n      comment: $comment\n    )\n  }\n"]);return nt=function(){return e},e}function at(){var e=Object(Ee.a)(["\n  mutation checkIfEmailExists($email: String!) {\n    checkIfEmailExists(\n      email: $email\n    )\n  }\n"]);return at=function(){return e},e}function rt(){var e=Object(Ee.a)(["\n  mutation checkIfUsernameExists($username: String!) {\n    checkIfUsernameExists(\n      username: $username\n    )\n  }\n"]);return rt=function(){return e},e}function st(){var e=Object(Ee.a)(["\n  mutation unFollowUser($_id: ID!) {\n    unFollowUser(\n      _id: $_id\n    )\n  }\n"]);return st=function(){return e},e}function ot(){var e=Object(Ee.a)(["\n  mutation followUser($_id: ID!) {\n    followUser(\n      _id: $_id\n    )\n  }\n"]);return ot=function(){return e},e}function it(){var e=Object(Ee.a)(["\n  mutation changeUserAvatar(\n    $avatarUrl: String!,\n  ) {\n    changeUserAvatar(\n      avatarUrl: $avatarUrl,\n    )\n  }\n"]);return it=function(){return e},e}function lt(){var e=Object(Ee.a)(["\n  mutation saveSettings(\n    $username: String,\n    $email: String,\n    $password: String\n  ) {\n    saveSettings(\n      username: $username,\n      email: $email,\n      password: $password,\n    )\n  }\n"]);return lt=function(){return e},e}function ct(){var e=Object(Ee.a)(["\n  mutation saveProfile(\n    $firstname: String,\n    $lastname: String,\n    $gender: String,\n    $birthday: String,\n    $locationStr: String,\n    $bio: String,\n  ) {\n    saveProfile(\n      firstname: $firstname,\n      lastname: $lastname,\n      gender: $gender,\n      birthday: $birthday,\n      locationStr: $locationStr,\n      bio: $bio,\n    )\n  }\n"]);return ct=function(){return e},e}function ut(){var e=Object(Ee.a)(["\n  query getSaved($sortType: String, $userId: String, $albumId: String, $tagId: String) {\n    getSaved(sortType: $sortType, userId: $userId, albumId: $albumId, tagId: $tagId) {\n      _id\n      createdAt\n      title\n      slug\n      excerpt\n      coverImg\n      author {\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return ut=function(){return e},e}function mt(){var e=Object(Ee.a)(["\n  query getFollowing($username: String!, $skip: Int, $limit: Int) {\n    getFollowing(username: $username, skip: $skip, limit: $limit) {\n      _id\n      username\n      isFollowing\n      roles\n      coins\n      profile {\n        name\n        bio\n        image\n      }\n    }\n  }\n"]);return mt=function(){return e},e}function dt(){var e=Object(Ee.a)(["\n  query getFollowers($username: String!, $skip: Int, $limit: Int) {\n    getFollowers(username: $username, skip: $skip, limit: $limit) {\n      _id\n      username\n      isFollowing\n      roles\n      coins\n      profile {\n        name\n        bio\n        image\n      }\n    }\n  }\n"]);return dt=function(){return e},e}function pt(){var e=Object(Ee.a)(["\n  query getPaidUsersFull ($duration: Int, $limit: Int) {\n    getPaidUsersFull (duration: $duration, limit: $limit) {\n      _id\n      username\n      roles\n      isFollowing\n      emails {\n        verified\n      }\n      profile {\n        name\n        image\n        bio\n      }\n      stats {\n        postsCount\n        followersCount\n      }\n    }\n  }\n"]);return pt=function(){return e},e}function gt(){var e=Object(Ee.a)(["\n  query getUser($username: String!) {\n    getUser(username: $username) {\n      _id\n      username\n      isFollowing\n      roles\n      coins\n      emails {\n        verified\n      }\n      roomId\n      isClassic\n      tariffs\n      currency\n      profile {\n        name\n        firstname\n        lastname\n        bio\n        city\n        website\n        twitterUser\n        instagramUser\n        vkUser\n        facebookUser\n        invitesCount\n        image\n        karma\n        badges {\n          url\n          image\n          desc\n        }\n      }\n      stats {\n        postsCount\n        albumsCount\n        booksCount\n        followersCount\n        followingCount\n        bookshelvesCount\n        savedCount\n        strikeCount\n        strikePostsCount\n        levitanDownloads\n      }\n    }\n  }\n"]);return gt=function(){return e},e}function ft(){var e=Object(Ee.a)(["\n  query getCurrentUser {\n    me {\n      _id\n      username\n      roles\n      coins\n      rooms\n      emails {\n        address\n        verified\n      }\n      profile {\n        name\n        firstname\n        lastname\n        gender\n        birthday\n        locationStr\n        unreadNotifications\n        image\n        bio\n      }\n      stats {\n        postsCount\n        followersCount\n        followingCount\n        sellingCount\n        soldCount\n        boughtCount\n      }\n    }\n  }\n"]);return ft=function(){return e},e}Ie()(ft());var ht=Ie()(gt()),vt=Ie()(pt()),bt=(Ie()(dt()),Ie()(mt()),Ie()(ut()),Ie()(ct()),Ie()(lt()),Ie()(it()),Ie()(ot()),Ie()(st()),Ie()(rt()),Ie()(at()),Ie()(nt()),Ie()(tt()),function(e){var t=e.keyword,n=e.skip,a=e.limit;return function(e,r){return e({type:v.PENDING}),console.log("searchPosts: ",t),ye.query({query:Ze,variables:{keyword:t,skip:n,limit:a}}).then(function(n){e({type:v.SUCCESS,payload:n.data.searchPosts,keyword:t,error:""})}).catch(function(t){e({type:v.ERROR,payload:t.message})})}}),yt=function(e){var t=e.keyword,n=e.skip,a=e.limit;return function(e,r){return e({type:b.PENDING}),console.log("searchUsers: ",t),ye.query({query:et,variables:{keyword:t,skip:n,limit:a}}).then(function(n){e({type:b.SUCCESS,payload:n.data.searchUsers,keyword:t,error:""})}).catch(function(t){e({type:b.ERROR,payload:t.message})})}},Et=function(e){var t=e.username,n=e.force;return function(e,a){return e({type:I.PENDING}),ye.query({skip:!t,query:ht,variables:{username:t},fetchPolicy:n?"network-only":"cache-first"}).then(function(t){e({type:I.SUCCESS,payload:t.data.getUser,error:""})}).catch(function(t){e({type:I.ERROR,payload:t.message})})}},kt=function(e){var t=e.duration,n=e.skip,a=e.limit;return function(e,r){return e({type:C.PENDING}),ye.query({query:vt,variables:{duration:t,skip:n,limit:a}}).then(function(t){e({type:C.SUCCESS,payload:t.data.getPaidUsersFull})}).catch(function(t){e({type:C.ERROR,payload:t.message})})}},It=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).goToUser=function(e){console.log("Go to user",n.props.user),console.log("Event data: ",e),n.props.go(e)},n.followUser=function(){},n.unFollowUser=function(){},n.state={},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"render",value:function(){var e=this.props.user,t=e.profile.image||"https://cdn.ryfma.com/defaults/icons/default_full_avatar.jpg";return t.indexOf("_full_")>0?t=t.replace("_full_","_medium_"):t.indexOf("graph.facebook.com")>0&&(t=t.replace("=large","=square")),r.a.createElement(Q.Cell,{id:e._id,className:"user-info-item",before:r.a.createElement(Q.Avatar,{size:36,src:e.profile.image}),description:e.profile.bio,onClick:this.goToUser,"data-view":"userpage","data-panel":"userpage","data-userid":e._id,"data-username":e.username,"data-headertitle":e.profile.name},e.profile.name)}}]),t}(a.Component),Pt=n(154),St=n.n(Pt),wt=n(155),Ct=n.n(wt),Ot=n(156),$t=n.n(Ot),Tt=(n(144),function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).goToUser=function(){},n.followUser=function(){},n.unFollowUser=function(){},n.state={},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"render",value:function(){var e=this.props.user,t=e.profile.image||"https://cdn.ryfma.com/defaults/icons/default_full_avatar.jpg";t.indexOf("_full_")>0?t=t.replace("_full_","_medium_"):t.indexOf("graph.facebook.com")>0&&(t=t.replace("=large","=square"));var n=e.profile.bio||"";n=n.length>40?n.substr(0,40)+"...":n;var a=null;return a=e.isFollowing?r.a.createElement(Q.Button,{size:"l",className:"ui gray basic button follow",onClick:this.unFollowUser,style:{marginTop:8}},"\u041e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f"):r.a.createElement(Q.Button,{size:"l",className:"ui green button follow",onClick:this.followUser,style:{marginTop:8}},"\u0427\u0438\u0442\u0430\u0442\u044c"),a=null,r.a.createElement(Q.Div,{id:e._id,style:{textAlign:"center",marginTop:8},className:"user-info-item"},r.a.createElement(Q.Avatar,{size:80,src:e.profile.image,style:{margin:"0 auto"},onClick:this.props.go,"data-view":"userpage","data-panel":"userpage","data-userid":e._id,"data-username":e.username,"data-headertitle":e.profile.name},r.a.createElement(St.a,{fill:"#FFFFFF"})),r.a.createElement("h2",{style:{marginBottom:"8px"},onClick:this.props.go,"data-view":"userpage","data-panel":"userpage","data-userid":e._id,"data-username":e.username,"data-headertitle":e.profile.name},e.profile.name),r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"12px"}},r.a.createElement("span",{style:{margin:"0 8px"}},r.a.createElement($t.a,null),e.stats.postsCount),r.a.createElement("span",{style:{margin:"0 8px"}},r.a.createElement(Ct.a,null),e.stats.followersCount)),r.a.createElement(Q.Cell,{multiline:!0},n),a)}}]),t}(a.Component)),jt=function(e){e.goToFunc;return r.a.createElement(Q.Group,null,r.a.createElement(Q.Cell,null,"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441"))},_t=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).handleSearch=function(e,t){var a=t||n.state.activeTab;e&&("posts"===a?n.props.searchPosts({keyword:e,limit:24}):"users"===a&&n.props.searchUsers({keyword:e,limit:24}))},n.changeTab=function(e){return function(){var t=n.state.keyword;n.setState({activeTab:e}),n.handleSearch(t,e)}},n.onChange=function(e){var t=n.state.activeTab;n.setState({keyword:e}),n.handleSearch(e,t)},n.fetchMorePosts=function(e){var t=n.props.posts;n.props.searchPosts({skip:t.length,limit:15})},n.fetchMoreUsers=function(e){var t=n.props.users;n.props.searchUsers({skip:t.length,limit:15})},n.state={keyword:"",activeTab:"users",searchResult:[]},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),this.props.getPaidUsers({})}},{key:"render",value:function(){var e=this,t=this.props,n=t.posts,a=t.users,s=t.paidUsers,o=t.isPendingPosts,i=t.isPendingUsers,l=(t.isPendingPaidUsers,this.state),c=l.keyword,u=l.activeTab;return r.a.createElement("div",null,r.a.createElement(Q.FixedLayout,{vertical:"top"},r.a.createElement(Q.Search,{value:this.state.search,onChange:this.onChange})),!c&&r.a.createElement("div",{className:"paid-users",style:{marginTop:56}},r.a.createElement(Q.Group,{title:"\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f"},s.map(function(t){return r.a.createElement(Tt,{user:t,go:e.props.go})})),r.a.createElement("div",{className:"get-started-block"},r.a.createElement("h3",null,"\u041f\u0443\u0431\u043b\u0438\u043a\u0443\u0439 \u0441\u0432\u043e\u0435 \u0442\u0432\u043e\u0440\u0447\u0435\u0441\u0442\u0432\u043e"),r.a.createElement("p",null,"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u0441\u0432\u043e\u0438\u0445 \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u0439 \u043d\u0430 Ryfma \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u0430"),r.a.createElement(Q.Button,{size:"l"},"\u0414\u0430\u0432\u0430\u0439\u0442\u0435 \u043d\u0430\u0447\u043d\u0435\u043c"))),c&&r.a.createElement(Q.Tabs,{theme:"light",style:{marginTop:56}},r.a.createElement(Q.TabsItem,{onClick:this.changeTab("users"),selected:"users"===u},"\u0410\u0432\u0442\u043e\u0440\u044b"),r.a.createElement(Q.TabsItem,{onClick:this.changeTab("posts"),selected:"posts"===u},"\u041f\u043e\u0441\u0442\u044b")),(i||o)&&r.a.createElement(Be,null),0===a.length&&"users"===u&&c&&r.a.createElement(jt,null),0===n.length&&"posts"===u&&c&&r.a.createElement(jt,null),a.length>0&&"users"===u&&r.a.createElement(Q.List,null,a.map(function(t){return r.a.createElement(Q.Div,{className:"user-info-wrapper"},r.a.createElement(It,{key:t._id,user:t,go:e.props.go}))}),r.a.createElement(Q.Div,null,r.a.createElement(Q.Button,{size:"xl",level:"secondary",onClick:this.fetchMoreUser},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))),n.length>0&&"posts"===u&&r.a.createElement(Q.List,null,n.map(function(t){return r.a.createElement(qe,{key:t._id,post:t,go:e.props.go})}),r.a.createElement(Q.Div,null,r.a.createElement(Q.Button,{size:"xl",level:"secondary",onClick:this.fetchMorePosts},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))}}]),t}(a.Component);var Ut=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{posts:e.search.posts,users:e.search.users,paidUsers:e.users.paidUsers,isPendingPosts:e.search.isPendingPosts,isPendingUsers:e.search.isPendingUsers,isPendingPaidUsers:e.users.isPendingPaidUsers}},function(e){return Object(i.b)({searchPosts:bt,searchUsers:yt,getPaidUsers:kt},e)})(_t);function Nt(){var e=Object(Ee.a)(["\n  query getFestPosts($festId: String!, $keyword: String, $city: String, $filterType: String, $sortType: String, $level: Int, $skip: Int, $limit: Int) {\n    festPosts(festId: $festId, keyword: $keyword, city: $city, filterType: $filterType, sortType: $sortType, level: $level, skip: $skip, limit: $limit) {\n      _id\n      festId\n      postId\n      userId\n      city\n      likeCount\n\n      author {\n        _id\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n\n      post {\n        _id\n        createdAt\n        title\n        slug\n        excerpt\n        htmlBody\n        coverImg\n        likeCount\n        liked\n        currUserLikes\n        commentsCount\n        userId\n        isAdultContent\n      }\n\n      juryStats {\n        userId\n        rating\n      }\n\n      stats {\n        juryCount\n        juryAverage\n        juryTotal\n      }\n    }\n  }\n"]);return Nt=function(){return e},e}function Rt(){var e=Object(Ee.a)(["\n  query getContest($slug: String, $festId: String) {\n    getContest(slug: $slug, festId: $festId) {\n      _id\n      ownerId\n      seoTitle\n      title\n      slug\n      brief\n      description\n      fromDate\n      toDate\n      acceptDate\n      sticky\n      coverImg\n      genres\n      entryFee\n      vkGroupLink\n      vkEventLink\n      fbGroupLink\n      topPrize\n      extraPrize\n      noJury\n      isFestival\n      isDuel\n      countries\n      levels\n      currentLevel\n      author {\n        _id\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n      usersData {\n        _id\n        username\n        roles\n        profile {\n          image\n          name\n        }\n      }\n      cities {\n        name\n        coordinates\n        partners {\n          name\n          brief\n          logoLink\n          url\n          images\n        }\n      }\n      curatorsData {\n        _id\n        username\n        profile {\n          name\n          image\n          city\n          vkUser\n        }        \n      }\n      juryData {\n        _id\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n      partners {\n        name\n        brief\n        logoLink\n        url\n        images\n      }\n      stats {\n        juryCount\n        countryCount\n        citiesCount\n        usersCount\n      }\n      comments {\n        _id\n        createdAt\n        postedAt\n        content\n        objectType\n        objectId\n        userId\n        author {\n          _id\n          username\n          roles\n          emails {\n            verified\n          }\n          profile {\n            name\n            image\n          }\n        }\n      }\n    }\n  }\n"]);return Rt=function(){return e},e}function Dt(){var e=Object(Ee.a)(["\n  query getFestivals(\n    $keyword: String,\n    $genreType: String,\n    $sortType: String,\n    $location: String,\n    $skip: Int,\n    $limit: Int\n    $isDuel: Boolean\n  ) {\n    getFestivals(\n      keyword: $keyword,\n      genreType: $genreType,\n      sortType: $sortType,\n      location: $location,\n      skip: $skip,\n      limit: $limit,\n      isDuel: $isDuel\n    ) {\n      _id\n      title\n      slug\n      brief\n      description\n      fromDate\n      toDate\n      sticky\n      coverImg\n      genres\n      entryFee\n      topPrize\n      extraPrize\n      countries\n      author {\n        _id\n        username\n        profile {\n          name\n          image\n        }\n      }\n      usersData {\n        _id\n        username\n        profile {\n          image\n        }\n      }\n      stats {\n        usersCount\n      }\n    }\n  }\n"]);return Dt=function(){return e},e}var Ft=Ie()(Dt()),Lt=Ie()(Rt()),xt=Ie()(Nt()),Mt=function(e){var t=e.slug,n=e.festId;return function(e,a){return e({type:j.PENDING}),ye.query({query:Lt,variables:{slug:t,festId:n}}).then(function(t){e({type:j.SUCCESS,payload:t.data.getContest,error:""})}).catch(function(t){e({type:j.ERROR,payload:t.message})})}},At=function(e){var t=e.keyword,n=e.genreType,a=e.sortType,r=e.location,s=e.skip,o=e.limit,i=e.isDuel;return function(e,l){return e({type:T.PENDING}),ye.query({query:Ft,variables:{keyword:t,genreType:n,sortType:a,location:r,skip:s,limit:o,isDuel:i}}).then(function(t){e({type:T.SUCCESS,payload:t.data.getFestivals,error:""})}).catch(function(t){e({type:T.ERROR,payload:t.message})})}},Gt=function(e){var t=e.festId,n=e.keyword,a=e.city,r=e.filterType,s=e.sortType,o=e.level,i=e.skip,l=e.limit;return function(e,c){return e({type:_.PENDING}),ye.query({query:xt,variables:{festId:t,keyword:n,city:a,filterType:r,sortType:s,level:o,skip:i,limit:l}}).then(function(t){e({type:_.SUCCESS,payload:t.data.festPosts,error:""})}).catch(function(t){e({type:_.ERROR,payload:t.message})})}},Bt=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).viewContest=function(){n.props.go()},n.state={},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"render",value:function(){var e=this.props.contest,t=e.coverImg||"https://cdn.ryfma.com/defaults/icons/default_full_avatar.jpg";return r.a.createElement(Q.Div,{id:e._id,onClick:this.props.go,"data-view":"contestpage","data-panel":"contestpage","data-contestid":e._id,"data-contestslug":e.slug,"data-headertitle":e.title},r.a.createElement("img",{src:t,style:{width:"100%",borderRadius:"6px"}}),r.a.createElement("h1",{style:{marginBottom:0}},e.title),r.a.createElement("div",null,r.a.createElement(Q.Link,null,e.author.profile.name)),r.a.createElement("div",null,e.brief),r.a.createElement("div",{className:"paticipants",style:{display:"flex",alignItems:"center",margin:"12px 0",marginLeft:"12px"}},e.usersData[0]&&r.a.createElement(Q.Link,{key:e.usersData[0]._id,to:"/u/"+e.usersData[0].username,style:{marginLeft:"-12px"}},r.a.createElement(Q.Avatar,{size:32,src:e.usersData[0].profile.image.replace("_full_","_small_")})),e.usersData[1]&&r.a.createElement(Q.Link,{key:e.usersData[1]._id,to:"/u/"+e.usersData[1].username,style:{marginLeft:"-12px"}},r.a.createElement(Q.Avatar,{size:32,src:e.usersData[1].profile.image.replace("_full_","_small_")})),e.usersData[2]&&r.a.createElement(Q.Link,{key:e.usersData[2]._id,to:"/u/"+e.usersData[2].username,style:{marginLeft:"-12px"}},r.a.createElement(Q.Avatar,{size:32,src:e.usersData[2].profile.image.replace("_full_","_small_")})),e.stats.usersCount>3?r.a.createElement("span",{style:{marginLeft:"8px"}},"+",e.stats.usersCount-3," \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"):0===e.stats.usersCount?r.a.createElement("span",{style:{marginLeft:"8px"}},"\u041d\u0435\u0442 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"):null),r.a.createElement(Q.Button,{size:"xl",style:{marginBottom:"24px"},onClick:this.props.go,"data-view":"contestpage","data-panel":"contestpage","data-contestid":e._id},"\u0423\u0437\u043d\u0430\u0442\u044c"))}}]),t}(a.Component),qt=function(e){e.goToFunc;return r.a.createElement(Q.Group,null,r.a.createElement(Q.Cell,null,"\u041a\u043e\u043d\u043a\u0443\u0440\u0441\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"))},Vt=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).changeTab=function(e){return function(){var t=n.state.keyword;n.setState({activeTab:e}),n.handleSearch(t,e)}},n.fetchMoreContests=function(e){var t=n.props.contests;n.props.getFestivalsInfo({skip:t.length,limit:7})},n.state={keyword:"",activeTab:"users",searchResult:[]},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),this.props.getFestivalsInfo({genreType:"\u0412\u0441\u0435 \u0436\u0430\u043d\u0440\u044b",sortType:"mostPeople",location:"worldwide"})}},{key:"render",value:function(){var e=this,t=this.props,n=t.contests,a=t.isPendingContests,s=this.state,o=s.keyword;s.activeTab;return r.a.createElement(Q.Group,{title:"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u043a\u043e\u043d\u043a\u0443\u0440\u0441\u044b"},a&&r.a.createElement(Be,null),0===n.length&&o&&r.a.createElement(qt,null),n.length>0&&r.a.createElement(Q.List,null,n.map(function(t){return r.a.createElement(Bt,{key:t._id,contest:t,go:e.props.go})}),r.a.createElement(Q.Div,null,r.a.createElement(Q.Button,{size:"xl",level:"secondary",onClick:this.fetchMoreContests},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))}}]),t}(a.Component);var zt=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{contests:e.contests.contests,isPendingContests:e.contests.isPendingContests}},function(e){return Object(i.b)({getFestivalsInfo:At},e)})(Vt),Wt=n(33),Ht=n.n(Wt),Yt=n(42),Jt=n(62),Kt=n.n(Jt),Qt=n(35);function Xt(){var e=Object(Ee.a)(["\n  mutation markCommentAsSpam($_id: ID!, $postUserId: String!, $commentUserId: String!, $spamScore: Int!) {\n    markCommentAsSpam(\n      _id: $_id,\n      postUserId: $postUserId,\n      commentUserId: $commentUserId,\n      spamScore: $spamScore\n    )\n  }\n"]);return Xt=function(){return e},e}function Zt(){var e=Object(Ee.a)(["\n  mutation deleteComment($_id: ID!, $userId: String!, $objectType: String!, $objectId: String!, $parentId: String) {\n    deleteComment(\n      _id: $_id,\n      userId: $userId,\n      objectType: $objectType,\n      objectId: $objectId,\n      parentId: $parentId\n    )\n  }\n"]);return Zt=function(){return e},e}function en(){var e=Object(Ee.a)(["\n  mutation updateComment(\n    $_id: ID!,\n    $content: String!,\n    $objectType: String!,\n    $objectId: String!,\n    $parentId: String\n  ) {\n    updateComment(\n      _id: $_id,\n      content: $content,\n      objectType: $objectType,\n      objectId: $objectId,\n      parentId: $parentId\n    )\n  }\n"]);return en=function(){return e},e}function tn(){var e=Object(Ee.a)(["\n  mutation insertComment(\n    $content: String!,\n    $objectType: String!,\n    $objectId: String!,\n    $parentId: String,\n    $title: String!,\n    $userId: String!\n    $ratingCount: Int,\n    $currRating: Float,\n    $newRating: Int,\n  ) {\n    insertComment(\n      content: $content,\n      objectType: $objectType,\n      objectId: $objectId,\n      parentId: $parentId,\n      title: $title,\n      userId: $userId,\n      ratingCount: $ratingCount,\n      currRating: $currRating,\n      newRating: $newRating,\n    ){\n      _id\n      createdAt\n      postedAt\n      content\n      objectType\n      objectId\n      parentId\n      userId\n      author {\n        _id\n        username\n        emails {\n          verified\n        }\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return tn=function(){return e},e}function nn(){var e=Object(Ee.a)(["\n  query getComments($objectId: String!, $parentId: String, $festId: String,  $skip: Int, $limit: Int) {\n    getComments(objectId: $objectId, parentId: $parentId, festId: $festId,  skip: $skip, limit: $limit) {\n      _id\n      createdAt\n      postedAt\n      content\n      slug\n      objectType\n      objectId\n      parentId\n      userId\n      spamScore\n      author {\n        _id\n        username\n        roles\n        emails {\n          verified\n        }\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return nn=function(){return e},e}var an=Ie()(nn()),rn=(Ie()(tn()),Ie()(en()),Ie()(Zt()),Ie()(Xt()),function(e){var t=e.objectId,n=e.parentId,a=e.festId,r=e.skip,s=e.limit;return function(e,o){return e({type:R.PENDING}),ye.query({query:an,variables:{objectId:t,parentId:n,festId:a,skip:r,limit:s}}).then(function(t){e({type:R.SUCCESS,payload:t.data.getComments,error:""})}).catch(function(t){e({type:R.ERROR,payload:t.message})})}}),sn=n(157),on=n.n(sn),ln=n(158),cn=n.n(ln),un=n(159),mn=n.n(un),dn=n(97),pn=n.n(dn),gn=function(e){function t(){return Object(V.a)(this,t),Object(W.a)(this,Object(H.a)(t).apply(this,arguments))}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"render",value:function(){var e=this.props,t=e.date,n=e.i18n,a=e.isComment,s="ru";n&&(s=n.language);var o="ru"===s?pn()(cn.a):pn()(mn.a);return r.a.createElement(on.a,{date:t,formatter:o,itemProp:a?"commentTime":"datePublished"})}}]),t}(r.a.PureComponent),fn=(n(300),function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).goToUser=function(e){console.log("Go to comment",n.props.comment),console.log("Event data: ",e),n.props.go(e)},n.followUser=function(){},n.unFollowUser=function(){},n.state={},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"render",value:function(){var e=this.props.comment,t=e.author.profile.image||"https://cdn.ryfma.com/defaults/icons/default_full_avatar.jpg";return t.indexOf("_full_")>0?t=t.replace("_full_","_medium_"):t.indexOf("graph.facebook.com")>0&&(t=t.replace("=large","=square")),r.a.createElement("div",{className:"comment-item"},r.a.createElement(Q.Cell,{key:e._id,id:e._id,size:"l",description:r.a.createElement(gn,{date:e.postedAt,isComment:!0}),before:r.a.createElement(Q.Avatar,{size:36,src:e.author.profile.image})},e.author.profile.name),r.a.createElement(Q.Div,{className:"content"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.content}})))}}]),t}(a.Component)),hn=function(e){e.goToFunc;return r.a.createElement(Q.Group,null,r.a.createElement(Q.Cell,null,"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442. \u0411\u0443\u0434\u044c \u043f\u0435\u0440\u0432\u044b\u043c!"))},vn=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).fetchMoreComments=function(e){e.activeTab,e.replaceFeed,e.skip;return function(){var e=n.props,t=e.objectId,a=e.parentId,r=e.festId,s=e.skip,o=e.limit;n.props.getCommentsFunc({objectId:t,parentId:a,festId:r,skip:s,limit:o})}},n.state={comments:[],activeTab:"latest",lastType:e.type,duration:e.duration},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),console.log("props: ",this.props);var e=this.props,t=e.objectId,n=e.parentId,a=e.festId,r=e.skip,s=e.limit;this.props.getCommentsFunc({objectId:t,parentId:n,festId:a,skip:r,limit:s})}},{key:"render",value:function(){var e=this,t=this.props,n=t.comments,a=t.isPendingComments;return console.log("comments: ",n),a?r.a.createElement(Be,null):0===n.length?r.a.createElement(Q.Group,null,r.a.createElement(hn,null)):r.a.createElement(Q.Group,{className:"comments-list"},r.a.createElement(Q.Div,null,r.a.createElement("h3",null,"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 (",n.length,")")),r.a.createElement(Q.List,null,n.map(function(t){return r.a.createElement(fn,{key:t._id,comment:t,go:e.props.go})}),this.state.comments.length>0&&r.a.createElement(Q.Div,null,r.a.createElement(Q.Button,{size:"xl",level:"secondary",onClick:this.fetchMoreComments({activeTab:this.state.activeTab,replaceFeed:!1,skip:this.state.comments.length})},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))}}]),t}(a.Component);var bn=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{comments:e.comments.comments,isPendingComments:e.comments.isPendingComments}},function(e){return Object(i.b)({getCommentsFunc:rn},e)})(vn),yn={wrapperId:"notification-wrapper",animationDuration:300,timeout:5e3,zIndex:1e4,colors:{error:{color:"#FFFFFF",backgroundColor:"#E85742"},success:{color:"#FFFFFF",backgroundColor:"#55CA92"},warning:{color:"#333333",backgroundColor:"#F5E273"},info:{color:"#FFFFFF",backgroundColor:"#4990E2"}}},En=new(function(){function e(){Object(V.a)(this,e)}return Object(z.a)(e,[{key:"styles",get:function(){return{container:{position:"fixed",width:"30%",margin:"0 auto",right:"0px",top:"-110px",left:"0px",textAlign:"center",zIndex:yn.zIndex,pointerEvents:"none",transition:"all "+yn.animationDuration+"ms ease",transform:"translateY(0px)",msTransition:"all "+yn.animationDuration+"ms ease",msTransform:"translateY(0px)",WebkitTransition:"all "+yn.animationDuration+"ms ease",WebkitTransform:"translateY(0px)",OTransition:"all "+yn.animationDuration+"ms ease",OTransform:"translateY(0px)",MozTransition:"all "+yn.animationDuration+"ms ease",MozTransform:"translateY(0px)"},content:{cursor:"pointer",display:"block",width:"auto",borderRadius:"0 0 4px 4px",backgroundColor:"white",padding:"8px 24px",pointerEvents:"all"},show:{transform:"translateY(108px)",msTransform:"translateY(108px)",WebkitTransform:"translateY(108px)",OTransform:"translateY(108px)",MozTransform:"translateY(108px)"},hide:{transform:"translateY(-108px)",msTransform:"translateY(-108px)",WebkitTransform:"translateY(-108px)",OTransform:"translateY(-108px)",MozTransform:"translateY(-108px)"}}}}]),e}()),kn=function(e){function t(){var e,n;Object(V.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(W.a)(this,(e=Object(H.a)(t)).call.apply(e,[this].concat(r)))).state={containerStyle:En.styles.container},n.getToastStyle=function(){var e=n.props,t=e.type,a=e.color,r=En.styles,s={};switch(t){case"success":case"error":case"warning":case"info":s=Object.assign({},r.content,yn.colors[t]);break;case"custom":var o={backgroundColor:a.background,color:a.text};s=Object.assign({},r.content,o);break;default:s=Object.assign({},r.content)}return s},n.animateState=function(){var e=En.styles;setTimeout(function(){n.updateStyle(e.show)},100),-1!==n.props.timeout&&setTimeout(function(){n.updateStyle(e.hide)},n.props.timeout)},n.updateStyle=function(e){var t=En.styles;n.setState({containerStyle:Object.assign({},t.container,e)})},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentDidMount",value:function(){this.animateState()}},{key:"render",value:function(){var e=this.props.text,t=this.state.containerStyle;return r.a.createElement("div",{className:"toast-notification",style:t},r.a.createElement("span",{style:this.getToastStyle()},e))}}]),t}(r.a.PureComponent),In=function(e,t,n,a){if(!document.getElementById(yn.wrapperId).hasChildNodes()){var s=n||yn.timeout;return function(e,t,n,a){var s=document.getElementById(yn.wrapperId);o.a.render(r.a.createElement(kn,{text:e,timeout:n,type:t,color:a}),s)}(e,t,s,a),-1===s?!1:(setTimeout(function(){!function(){var e=document.getElementById(yn.wrapperId);o.a.unmountComponentAtNode(e)}()},s+yn.animationDuration),!0)}return!1},Pn={error:function(e){e.graphQLErrors?In(e.graphQLErrors[0].message,"error",1e4):In(e,"error",1e4)},success:function(e){In(e,"success",3e3)},warning:function(e){In(e,"warning",6e3)}},Sn=function(e){function t(){return Object(V.a)(this,t),Object(W.a)(this,Object(H.a)(t).apply(this,arguments))}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentDidMount",value:function(){var e;e=this.props.options,yn=Object.assign(yn,e)}},{key:"render",value:function(){return r.a.createElement("div",{id:"notification-wrapper"})}}]),t}(r.a.PureComponent),wn=function(e){e.goToFunc;return r.a.createElement(Q.Group,null,r.a.createElement(Q.Cell,null,"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043f\u043e\u0441\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"))},Cn=n(160),On=n.n(Cn),$n=n(161),Tn=n.n($n),jn=n(162),_n=n.n(jn),Un=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).likePost=Kt()(Object(Yt.a)(Ht.a.mark(function e(){var t,a,r,s,o,i,l,c;return Ht.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.currUser){e.next=4;break}return Sn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b"),e.abrupt("return");case 4:return t=n.props.post,a=t.title,r=t.userId,s=t._id,o=n.state,i=o.totalLikes,l=o.currUserLikes,c=l>50?50:l,e.prev=7,e.next=10,n.props.likePost({_id:s,title:a,userId:r,totalLikes:c,likes:l-i});case 10:Qt.a.event({category:"Post",action:"PostLiked",value:c}),n.setState(function(e){return{hearts:[],totalLikes:e.likes}}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),Sn.error(e.t0);case 17:case"end":return e.stop()}},e,this,[[7,14]])})),2e3),n.createLikes=function(){if(n.props.currUser){var e=n.state.hearts||[],t=n.state.currUserLikes;t+=1;var a=Math.floor(100*Math.random()+1),s=(Math.random()*(1.6-1.2)+1.2).toFixed(1);e.push({id:"part-"+a,content:r.a.createElement("div",{key:"part-"+a,className:"heartAnim part-".concat(a),style:{display:"block",fontSize:Math.floor(28*Math.random()+22)+"px",animation:["flowOne","flowTwo","flowThree"][Math.floor(3*Math.random())]+" "+s+"s linear"}},r.a.createElement("i",{"aria-hidden":"true",className:"icon heart ".concat(["colOne","colTwo","colThree","colFour","colFive","colSix"][Math.floor(6*Math.random())])}))}),n.setState({hearts:e,currUserLikes:t}),setTimeout(function(){var t=e.map(function(e){return e.id}).indexOf("part-"+a);e.splice(t,1),n.setState({hearts:e})},900*s)}else Sn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b")},n.setNewLike=function(){n.props.currUser?n.state.currUserLikes<50&&(n.createLikes(),n.setState({liked:!0,likes:n.state.likes+1}),n.likePost()):Sn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b")},n.state={likes:0,liked:!1,hearts:[]},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount PostPage"),console.log("props: ",this.props),this.props.getPostContents({postId:this.props.postId}),window.scrollTo(0,0)}},{key:"render",value:function(){var e=this.props,t=e.postInfo;if(e.isPendingContentsPostInfo)return r.a.createElement(Be,null);if(!t)return r.a.createElement(wn,null);var n=this.state.likes,a=(t.viewCount,this.state.liked);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.Group,null,r.a.createElement(Q.Div,{className:"post-page"},r.a.createElement("h2",null,t.title),r.a.createElement("img",{src:t.coverImg,style:{width:"100%",borderRadius:6}}),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.htmlBody}}),t.tags&&r.a.createElement(Q.List,{className:"post-tags"},t.tags.map(function(e){return r.a.createElement("span",null,r.a.createElement(Q.Link,{to:"/tags/".concat(e._id,"/").concat(e.name)},e.name))})),r.a.createElement("div",{className:"tags-hint"},r.a.createElement("div",null,r.a.createElement("b",null,"\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0441\u0442\u0443 \u043e\u0442 1 \u0434\u043e 50 \u043b\u0430\u0439\u043a\u043e\u0432!"))),r.a.createElement("div",{className:"meta post-footer"},r.a.createElement("div",{className:"post-stat-share"},r.a.createElement("div",{key:0,className:"like-block"},r.a.createElement("div",{className:"post-like-label ui label basic ".concat(a?"liked":"")},a?r.a.createElement(_n.a,null):r.a.createElement("div",{className:"like-container"},r.a.createElement(Tn.a,null),r.a.createElement("div",{className:"pulse-ring"})),r.a.createElement("div",{className:"hearts"},this.state.hearts.map(function(e){return e.content}))),r.a.createElement(Q.Link,{to:"/p/".concat(t._id,"/").concat(t.slug,"/likers"),className:"likers-count"},n)),r.a.createElement("div",{key:1,className:"stats-block"},r.a.createElement("a",{href:"#comments",className:"ui label basic post-comment-label"},r.a.createElement(On.a,null),r.a.createElement("span",null,t.commentsCount))))),t.author&&r.a.createElement(It,{user:t.author,go:this.props.go,isPost:!0,isShortBio:!0}))),r.a.createElement(bn,{author:t.author,objectType:"post",objectId:t._id,title:t.title,commentsCount:t.commentsCount}))}}]),t}(a.Component);var Nn=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{postInfo:e.posts.postInfo,isPendingContentsPostInfo:e.posts.isPendingContentsPostInfo}},function(e){return Object(i.b)({getPostContents:Ge},e)})(Un),Rn=n(80),Dn=function(e){e.goToFunc;return r.a.createElement(Q.Group,null,r.a.createElement(Q.Cell,null,"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043a\u043e\u043d\u043a\u0443\u0440\u0441 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"))},Fn=(n(145),function(e){function t(e){var n;Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).handleChange=function(e){n.setState({sliderValue:e})},n.handleChangeComplete=Kt()(Object(Yt.a)(Ht.a.mark(function e(){var t,a,r,s,o,i,l;return Ht.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.currUserId&&n.props.isJury){e.next=4;break}return Pn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b"),e.abrupt("return");case 4:return t=n.props.currentLevel,a=n.props.post,r=a.userId,s=a._id,o=n.state,i=o.sliderValue,l=o.changeRating,e.prev=7,e.next=10,n.props.rateFestPost({festId:n.props.festId,postId:s,userId:r,rating:i,changeRating:i-l,level:t});case 10:Qt.a.event({category:"Contest",action:"JuryRated",value:i}),n.setState({rating:i,changeRating:i}),Pn.success("\u041e\u0446\u0435\u043d\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430!"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),Pn.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[7,15]])})),500),n.createLikes=function(){if(n.props.currUserId){var e=n.state.hearts||[],t=n.state.currUserLikes;t+=1;var a=Math.floor(100*Math.random()+1),s=(Math.random()*(1.6-1.2)+1.2).toFixed(1);e.push({id:"part-"+a,content:r.a.createElement("div",{key:"part-"+a,className:"heartAnim part-".concat(a),style:{display:"block",fontSize:Math.floor(28*Math.random()+22)+"px",animation:["flowOne","flowTwo","flowThree"][Math.floor(3*Math.random())]+" "+s+"s linear"}},r.a.createElement("i",{name:"heart",className:"".concat(["colOne","colTwo","colThree","colFour","colFive","colSix"][Math.floor(6*Math.random())])}))}),n.setState({hearts:e,currUserLikes:t}),setTimeout(function(){var t=e.map(function(e){return e.id}).indexOf("part-"+a);e.splice(t,1),n.setState({hearts:e})},900*s)}else Pn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b")},n.likePost=Kt()(Object(Yt.a)(Ht.a.mark(function e(){var t,a,r,s,o,i,l,c;return Ht.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.currUserId){e.next=4;break}return Pn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b"),e.abrupt("return");case 4:return t=n.props.post.post,a=t.title,r=t.userId,s=t._id,o=n.state,i=o.totalLikes,l=o.currUserLikes,c=l>50?50:l,e.prev=7,e.next=10,n.props.likePost({_id:s,title:a,userId:r,totalLikes:c,likes:l-i});case 10:Qt.a.event({category:"Post",action:"PostLiked",value:c}),n.setState({hearts:[],totalLikes:c}),setTimeout(function(){n.setState({hearts:[]})},500),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),Pn.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[7,15]])})),2e3),n.setNewLike=function(){n.props.currUserId?n.state.currUserLikes<50&&(n.createLikes(),n.setState({liked:!0,likes:n.state.likes+1}),n.likePost()):Pn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b")},n.handleComments=function(){n.setState({showComments:!0})};var a=e.currUserId,s=n.props.post.juryStats,o=0;if(s)for(var i=0;i<s.length;i++)s[i].userId===a&&(o=s[i].rating);var l=e.post.post,c=l.liked,u=l.currUserLikes;return n.state={showFull:!1,showComments:e.showComments,sliderValue:o,changeRating:o,likes:e.post.likeCount,liked:c,totalLikes:0===u&&c?1:u,currUserLikes:0===u&&c?1:u,hearts:[],isAdultContent:e.post.post.isAdultContent},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentDidMount",value:function(){var e=Object(Yt.a)(Ht.a.mark(function e(){return Ht.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.props.post.post._id){e.next=4;break}return e.next=4,this.props.increasePostViewCount({_id:this.props.post.post._id});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}},e,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.post;if(!e.author)return null;var t=e.post.excerpt;return r.a.createElement("div",{id:e._id,className:"post-list-item"},r.a.createElement(Q.Cell,{size:"l",description:"\u043e\u0442 "+e.author.profile.name,before:r.a.createElement(Q.Avatar,{size:36,src:e.author.profile.image}),onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},e.post.title),r.a.createElement(Q.Div,{className:"content",onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},e.coverImg&&r.a.createElement(Q.Avatar,{type:"image",src:e.coverImg,className:"post-image"}),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})),r.a.createElement(Q.Cell,{onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},r.a.createElement(Q.Link,{onClick:this.goToPost},"\u0427\u0438\u0442\u0430\u0442\u044c \u0434\u0430\u043b\u0435\u0435")))}}]),t}(r.a.Component)),Ln=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).refetchData=function(){n.setState({refreshing:!0}),n.props.getFestPostsInfo({festId:n.props.festId,keyword:n.props.keyword,sortType:n.props.sortType,filterType:n.props.filterType,city:n.props.citySelected,skip:0,limit:8}).then(function(){n.setState({refreshing:!1})})},n.fetchMorePosts=function(){var e=n.props.contestPosts;n.props.getPosts({festId:n.props.festId,keyword:n.props.keyword,sortType:n.props.sortType,filterType:n.props.filterType,city:n.props.citySelected,skip:e.length,limit:8})},n.state={contestPosts:[]},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),console.log("festPosts: ",this.props),this.props.getFestPostsInfo({festId:this.props.fest._id,keyword:this.props.keyword,sortType:this.props.sortType,filterType:this.props.filterType,city:this.props.citySelected,skip:0,limit:8})}},{key:"render",value:function(){var e=this,t=this.props,n=t.contestPosts,a=t.isPendingLatestPosts;return n?0===n.length?r.a.createElement(Ve,null):r.a.createElement("div",{className:"contest-posts-wrapper"},r.a.createElement("h2",null,"\u0421\u0442\u0438\u0445\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"),r.a.createElement("div",{className:"ui segment user-posts"},r.a.createElement("h3",null,"\u041d\u0435 \u0441\u0442\u0435\u0441\u043d\u044f\u0439\u0442\u0435\u0441\u044c \u043e\u0431\u0441\u0443\u0436\u0434\u0430\u0442\u044c \u0438 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0442\u044c \u043b\u0430\u0439\u043a\u0430\u043c\u0438 (\u043e\u0442 0 \u0434\u043e 50) \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f"),r.a.createElement(Q.List,null,n.map(function(t){return r.a.createElement(Fn,{key:t._id,post:t,go:e.props.go})}),a&&r.a.createElement(Be,null),r.a.createElement(Q.Div,null,r.a.createElement(Q.Button,{size:"xl",level:"secondary",onClick:this.fetchMorePosts},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))):r.a.createElement(Ve,null)}}]),t}(a.Component);var xn=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{contestPosts:e.contests.contestPosts,isPendingContestPosts:e.contests.isPendingContestPosts}},function(e){return Object(i.b)({getFestPostsInfo:Gt},e)})(Ln),Mn=n(163),An=n.n(Mn),Gn=n(164),Bn=n.n(Gn),qn=An()();qn.tlds(Bn.a);var Vn=function(e){var t=e,n=t.match(/<a\b[^>]*>(.*?)<\/a>/gi);n&&n.map(function(e){var n=e.match(/<a [^>]+>([^<]+)<\/a>/i);n&&(t=t.replace(e,n[1]))});var a=(t=function(e){var t=e,n=qn.match(e);return n&&n.map(function(e){t=e.url.includes("ryfma.com")?t.replace(e.url,"<a href='".concat(e.url,"' class='away-link'>").concat(e.url,"</a>")):t.replace(e.url,"<a href='".concat(e.url,"' class='away-link' rel='nofollow noopener' target='_blank'>").concat(e.url,"</a>"))}),t}(t)).match(/\B[@\uff20][a-z0-9_-]+/gi);return a&&(t=a.map(function(e){return t.replace(e,"<a href='/u/".concat(e.replace("@","").replace("\uff20",""),"' class='mention-link' target='_blank'>").concat(e,"</a>"))})),t},zn=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).changeSort=function(e){return function(t){n.setState({sortType:e})}},n.handleDesc=function(){n.setState({showDesc:!n.state.showDesc})},n.levelDone=function(e){return Object(Yt.a)(Ht.a.mark(function t(){var a,r,s,o;return Ht.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.state,r=a.minJuryRating,s=a.amountOfPosts,o={_id:n.props.contest._id,levelDone:e,minJuryRating:r,amountOfPosts:s},t.prev=2,t.next=5,n.props.updateContestLevel(o);case 5:Notification.success(n.props.t("common:notif.contestUpdated")),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),Notification.error(t.t0);case 11:case"end":return t.stop()}},t,this,[[2,8]])}))},n.handleInputChange=function(e){var t=e.target,a=t.value,r=t.name;n.setState(Object(Rn.a)({},r,a))},n.state={fetchedUser:e.fetchedUser,sortType:"jury",showDesc:!1,minJuryRating:0,amountOfPosts:0},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount PostPage"),this.props.getContestInfo({slug:this.props.contestSlug,festId:this.props.contestId})}},{key:"render",value:function(){var e=this,t=this.props,n=t.contest;if(t.isPendingContest)return r.a.createElement(Be,null);if(!n)return r.a.createElement(Dn,null);var a=this.state,s=a.sortType,o=(a.minJuryRating,a.amountOfPosts,a.fetchedUser),i=n;i.isFestival;var l=i.currentLevel||1,c=l,u=new Date,m=(new Date(i.fromDate),new Date(i.toDate)),d=o?o._id:null,p=o,g=i.juryData.map(function(e){return e._id}).includes(d),f=i.description||"",h=f.split("\n"),v=0,b=[],y=[];h.map(function(e,t){v<412?e?(v+=e.length,b.push(r.a.createElement("p",{key:t,dangerouslySetInnerHTML:{__html:"".concat(Vn(e))}}))):b.push(r.a.createElement("br",{key:t})):e?y.push(r.a.createElement("p",{key:t,dangerouslySetInnerHTML:{__html:"".concat(Vn(e))}})):y.push(r.a.createElement("br",{key:t}))});var E=[];if(i.levels>1){for(var k=1;k<i.levels;k++)E.push(r.a.createElement(Q.TabsItem,{className:c===k?"level item active":"level item"},"\u042d\u0442\u0430\u043f ",k," ",k<l?"(\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d)":""," ",k===l?"\u0422\u0435\u043a\u0443\u0449\u0438\u0439":""));E.push(r.a.createElement(Q.TabsItem,{className:c===i.levels?"level item active":"level item"},"\u0424\u0438\u043d\u0430\u043b"))}var I=c===i.levels;return r.a.createElement(Q.Group,{id:n._id},r.a.createElement(Q.Div,{className:"fest-page"},i.coverImg&&r.a.createElement("div",{className:"ui image"},r.a.createElement("img",{className:"contest-banner",itemProp:"image",src:i.coverImg,alt:i.genres?i.title+". "+i.genres.map(function(e){return e}).join(","):i.title})),u>m&&r.a.createElement("div",{className:"winners ".concat(s)},r.a.createElement("h1",null,"\u041f\u043e\u0431\u0435\u0434\u0438\u0442\u0435\u043b\u0438"),r.a.createElement(Q.Tabs,{type:"buttons"},r.a.createElement(Q.TabsItem,{onClick:function(){return e.setState({sortType:"jury"})},selected:"jury"===this.state.sortType},"\u0412\u044b\u0431\u043e\u0440 \u0436\u044e\u0440\u0438"),r.a.createElement(Q.TabsItem,{onClick:function(){return e.setState({sortType:"likes"})},selected:"likes"===this.state.sortType},"\u0412\u044b\u0431\u043e\u0440 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"))),r.a.createElement(Q.Tabs,{type:"buttons"},r.a.createElement(Q.TabsItem,{selected:!0},"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),r.a.createElement(Q.TabsItem,null,"\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432")),r.a.createElement("h1",{itemProp:"name"},i.title),r.a.createElement("div",{className:"contest-body"},f.length>412?r.a.createElement("div",{className:"fest-desc"},r.a.createElement("div",{className:"slide-down",itemProp:"description"},b,!this.state.showDesc&&r.a.createElement("div",{className:"slide-fade"})),r.a.createElement("div",{className:this.state.showDesc?"slide-down-hidden open":"slide-down-hidden",itemProp:"description"},y),r.a.createElement("div",{className:"slide-down-button",onClick:this.handleDesc},this.state.showDesc?"\u0421\u043a\u0440\u044b\u0442\u044c":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e")):r.a.createElement("span",{itemProp:"description"},b)),i.partners&&r.a.createElement("div",{className:"partners"},r.a.createElement("h3",null,"\u041f\u0440\u0438\u0437\u044b \u043e\u0442 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432"),r.a.createElement("div",{className:"partner-name"},i.partners[0].logoLink.includes("<svg")?r.a.createElement("div",{className:"partner-logo",dangerouslySetInnerHTML:{__html:i.partners[0].logoLink}}):r.a.createElement("img",{src:i.partners[0].logoLink,className:"partner-logo"}),r.a.createElement("h4",null,i.partners[0].name)),r.a.createElement("div",{className:"partner-brief",dangerouslySetInnerHTML:{__html:i.partners[0].brief}}),r.a.createElement("div",{className:"partner-images"},r.a.createElement("div",{className:"partner-image"},r.a.createElement("img",{src:i.partners[0].images[0]})),r.a.createElement("div",{className:"partner-image"},r.a.createElement("img",{src:i.partners[0].images[1]})),r.a.createElement("div",{className:"partner-image"},r.a.createElement("img",{src:i.partners[0].images[2]}))),r.a.createElement("a",{href:"".concat(i.partners[0].url,"?utm_source=ryfma&utm_medium=contest&utm_campaign=partner"),target:"_blank",rel:"noopener nofollow",className:"ui button partner-more"},"\u0411\u043e\u043b\u044c\u0448\u0435 \u043f\u0440\u0438\u0437\u043e\u0432")),E.length>0&&r.a.createElement(Q.Tabs,{type:"buttons",className:"level-filters"},E),r.a.createElement(xn,{fest:i,currentLevel:c,isMultiLevel:E.length>1,isFinal:I,isJury:g,juryId:d,currUser:p,go:this.props.go})))}}]),t}(a.Component);var Wn=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{contest:e.contests.contestInfo,isPendingContest:e.contests.isPendingContest}},function(e){return Object(i.b)({getContestInfo:Mt},e)})(zn),Hn=function(e){e.goToFunc;return r.a.createElement(Q.Group,null,r.a.createElement(Q.Cell,null,"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"))},Yn=n(165),Jn=n.n(Yn),Kn=n(166),Qn=n.n(Kn),Xn=n(167),Zn=n.n(Xn),ea=n(168),ta=n.n(ea),na=n(169),aa=n.n(na),ra=n(170),sa=n.n(ra),oa=n(171),ia=n.n(oa),la=n(172),ca=n.n(la),ua=n(173),ma=n.n(ua),da=n(98),pa=n.n(da),ga=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).handleDesc=function(){n.setState({showDesc:!n.state.showDesc})},n.state={showBio:!1,activeTab:"latest"},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount UserPage"),console.log("props: ",this.props),this.props.getUserInfo({username:this.props.username}),window.scrollTo(0,0)}},{key:"render",value:function(){var e=this.props,t=e.user;if(e.isPendingUser)return r.a.createElement(Be,null);if(!t)return r.a.createElement(Hn,null);if(!t.profile)return r.a.createElement(Hn,null);var n=[t.profile.vkUser,t.profile.instagramUser,t.profile.twitterUser,t.profile.facebookUser].map(function(e){if(e)return e.replace("https://","").replace("http://","").replace("www.","")}),a=(t.profile.bio||"").split("\n"),s=0,o=[],i=[];return a.map(function(e,t){s<80?e&&(s+=e.length,o.push(r.a.createElement("span",{key:t,dangerouslySetInnerHTML:{__html:"".concat(Vn(e))}}))):e&&i.push(r.a.createElement("span",{key:t,dangerouslySetInnerHTML:{__html:"".concat(Vn(e))}}))}),r.a.createElement("div",null,r.a.createElement(Q.Group,null,r.a.createElement(Q.Div,{className:"user-page"},r.a.createElement(Q.Avatar,{size:130,src:t.profile.image}),r.a.createElement("div",{className:"content"},r.a.createElement("h1",null,t.profile.name,t.emails?t.emails[0].verified&&r.a.createElement(Jn.a,null):null),r.a.createElement("div",{className:"karma"},r.a.createElement(Qn.a,{fill:"red"}),t.profile.karma.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),"\xa0\u041a\u0430\u0440\u043c\u0430"),(t.profile.city||t.profile.website)&&r.a.createElement("div",{className:"website-city"},t.profile.website&&r.a.createElement("div",{className:"user-website"},r.a.createElement(Qt.a.OutboundLink,{eventLabel:"Go to User website",to:"http://".concat(t.profile.website.replace("https://","").replace("http://","")),target:"_blank",rel:"noopener nofollow",className:"item",role:"listitem",itemProp:"url"},r.a.createElement(Zn.a,null),function(e){var t=function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]}(e),n=t.split("."),a=n.length;return a>2&&(t=n[a-2]+"."+n[a-1],2===n[a-1].length&&2===n[a-1].length&&(t=n[a-3]+"."+t)),t}(t.profile.website.replace("https://","").replace("http://","")))),t.profile.city&&r.a.createElement("div",{className:"user-city"},r.a.createElement(ta.a,null),t.profile.city)),n.length&&r.a.createElement("div",{className:"meta"},r.a.createElement("div",{className:"ui list link horizontal"},t.profile.vkUser?r.a.createElement(Qt.a.OutboundLink,{eventLabel:"Go to User VK",to:"https://vk.com/".concat(n[0].replace("vk.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item vk",itemProp:"sameAs"},r.a.createElement(aa.a,null)):null,t.profile.instagramUser?r.a.createElement(Qt.a.OutboundLink,{eventLabel:"Go to User Instagram",to:"https://instagram.com/".concat(n[1].replace("instagram.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item in",itemProp:"sameAs"},r.a.createElement(sa.a,null)):null,t.profile.twitterUser?r.a.createElement(Qt.a.OutboundLink,{eventLabel:"Go to User Twitter",to:"https://twitter.com/".concat(n[2].replace("twitter.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item tw",itemProp:"sameAs"},r.a.createElement(ia.a,null)):null,t.profile.facebookUser?r.a.createElement(Qt.a.OutboundLink,{eventLabel:"Go to User Facebook",to:"https://facebook.com/".concat(n[3].replace("facebook.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item fb",itemProp:"sameAs"},r.a.createElement(ca.a,null)):null,t.profile.youtubeUser?r.a.createElement(Qt.a.OutboundLink,{eventLabel:"Go to User Youtube",to:"https://youtube.com/".concat(n[4].replace("youtube.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item youtube",itemProp:"sameAs"},r.a.createElement(ma.a,null)):null)),r.a.createElement(Q.HorizontalScroll,{className:"user-stats"},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.postsCount||0),"\u041f\u043e\u0441\u0442\u043e\u0432"),r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.albumsCount||0),"\u0410\u043b\u044c\u0431\u043e\u043c\u043e\u0432"),r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.booksCount||0),"\u041a\u043d\u0438\u0433"),r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.followersCount||0),"\u0427\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"),r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.followingCount||0),"\u0427\u0438\u0442\u0430\u0435\u043c\u044b\u0445"))),t.profile.bio&&r.a.createElement("div",{className:"extra"},t.profile.bio.length>80?r.a.createElement("div",{className:"user-bio"},r.a.createElement("div",{className:"slide-down",itemProp:"description"},o,!this.state.showDesc&&r.a.createElement("div",{className:"slide-fade"})),r.a.createElement("div",{className:this.state.showDesc?"slide-down-hidden open":"slide-down-hidden",itemProp:"description"},i),r.a.createElement("div",{className:"slide-down-button",onClick:this.handleDesc},(this.state.showDesc,r.a.createElement(pa.a,null)))):r.a.createElement("span",{itemProp:"description"},o))))),r.a.createElement(We,{type:this.state.activeTab,shortPost:this.props.shortPost,hideAds:!0,userId:t._id,currUser:this.props.currUser,limit:this.props.limit,keyword:this.state.keyword,go:this.props.go,personal:!0,replaceFeed:this.props.replaceFeed}))}}]),t}(a.Component);var fa=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{user:e.users.user,isPendingUser:e.users.isPendingUser}},function(e){return Object(i.b)({getUserInfo:Et},e)})(ga),ha=function(e){function t(e){var n;return Object(V.a)(this,t),(n=Object(W.a)(this,Object(H.a)(t).call(this,e))).getUserInfo=function(){K.a.subscribe(function(e){switch(e.detail.type){case"VKWebAppGetUserInfoResult":n._isMounted&&n.setState({fetchedUser:e.detail.data,activeTab:"myfeed"});break;case"VKWebAppGetUserInfoFailed":n._isMounted&&n.setState({userInfoDenied:!0,activeTab:"latest"});break;default:n.setState({activeTab:"latest"})}}),K.a.send("VKWebAppGetUserInfo",{})},n.getTheme=function(){K.a.subscribe(function(e){switch(e.detail.type){case"VKWebAppUpdateConfig":var t=document.createAttribute("scheme");t.value=e.detail.data.scheme?e.detail.data.scheme:"client_light",document.body.attributes.setNamedItem(t)}})},n.go=function(e){var t=e.currentTarget.dataset,a=t.view,r=t.panel,s=t.postid,o=t.contestid,i=t.contestslug,l=t.userid,c=t.username,u=t.headertitle,d=n.state,p=d.activeStory,g=d.activeView,f=d.activeTab,h=d.activePanel;console.log("New params: ",e.currentTarget.dataset);var v={activeStory:"modalPages",activeTab:null,returnStory:"modalPages"===p?"modalPages":"epicPages",returnView:g,returnPanel:h,returnTab:f};r&&(v=Object(m.a)({},v,{activePanel:r})),a&&(v=Object(m.a)({},v,{activeView:a})),s&&(v=Object(m.a)({},v,{postId:s})),o&&(v=Object(m.a)({},v,{contestId:o,contestSlug:i})),l&&(v=Object(m.a)({},v,{userId:l,username:c})),u&&(v=Object(m.a)({},v,{headerModalTitle:u})),n.setState(v)},n.returnTo=function(){var e=n.state,t=e.returnStory,a=e.returnView,r=e.returnPanel,s=e.returnTab;console.log("returnTo: ",n.state),n.setState({activeStory:t||"epicPages",activeView:a||"feed",activePanel:r||"feed",activeTab:s||"latest",returnStory:null,returnView:null,returnPanel:null,returnTab:null})},n.onStoryChange=function(e){return function(t){var a=t.currentTarget.dataset,r=a.story,s=a.epictab;console.log("story change",t.currentTarget.dataset),"epicPages"===r?n.setState({activeStory:r,epicTab:s,activeView:e,activeTab:"latest"}):n.setState({activeStory:r,epicTab:s,activeView:e})}},n.state={activeStory:"epicPages",activeView:"feed",activePanel:"feed",activeTab:"latest",epicTab:"feed",username:"polina",headerModalTitle:"\u041f\u043e\u043b\u0438\u043d\u0430 (Pola) \u0428\u0438\u0431\u0435\u0435\u0432\u0430",popularTab:"day",fetchedUser:null,userInfoDenied:!1},n}return Object(Y.a)(t,e),Object(z.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){X.clear(),this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.state,n=t.fetchedUser;t.userInfoDenied;console.log("state: ",this.state);var a=Object(Q.platform)();return r.a.createElement(Q.Epic,{activeStory:this.state.activeStory,tabbar:r.a.createElement(Q.Tabbar,null,r.a.createElement(Q.TabbarItem,{onClick:this.onStoryChange("feed"),selected:"feed"===this.state.epicTab,"data-story":"epicPages","data-epictab":"feed"},r.a.createElement(re.a,null)),r.a.createElement(Q.TabbarItem,{onClick:this.onStoryChange("search"),selected:"search"===this.state.epicTab,"data-story":"epicPages","data-epictab":"search"},r.a.createElement(oe.a,null)),r.a.createElement(Q.TabbarItem,{onClick:this.onStoryChange("contests"),selected:"contests"===this.state.epicTab,"data-story":"epicPages","data-epictab":"contests"},r.a.createElement(le.a,null)))},r.a.createElement(Q.Root,{id:"epicPages",activeView:this.state.activeView},r.a.createElement(Q.View,{id:"feed",activePanel:"feed"},r.a.createElement(Q.Panel,{id:"feed"},r.a.createElement(Q.PanelHeader,{noShadow:!0,left:r.a.createElement(Q.HeaderButton,null),right:r.a.createElement(Q.HeaderButton,null)},"\u041b\u0435\u043d\u0442\u0430 \u043f\u043e\u0441\u0442\u043e\u0432"),r.a.createElement(Q.FixedLayout,{vertical:"top"},r.a.createElement(Q.Tabs,{theme:"header",type:"buttons"},r.a.createElement(Q.HorizontalScroll,null,this.state.fetchedUser&&r.a.createElement(Q.TabsItem,{onClick:function(){return e.setState({activeTab:"myfeed"})},selected:"myfeed"===this.state.activeTab},"\u041c\u043e\u044f \u043b\u0435\u043d\u0442\u0430"),r.a.createElement(Q.TabsItem,{onClick:function(){return e.setState({activeTab:"latest"})},selected:"latest"===this.state.activeTab},"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435"),r.a.createElement(Q.TabsItem,{onClick:function(){return e.setState({activeTab:"popular"})},selected:"popular"===this.state.activeTab},"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0435")))),this.state.fetchedUser&&"myfeed"===this.state.activeTab&&r.a.createElement(Q.Root,{activeView:"latest"},r.a.createElement(Q.View,{id:"latest",activePanel:"latest"},r.a.createElement(Q.Panel,{id:"latest"},r.a.createElement(We,{go:this.go,type:"myfeed",personal:!0})))),"latest"===this.state.activeTab&&r.a.createElement(Q.Root,{activeView:"latest"},r.a.createElement(Q.View,{id:"latest",activePanel:"latest"},r.a.createElement(Q.Panel,{id:"latest"},r.a.createElement(We,{go:this.go,type:"latest"})))),"popular"===this.state.activeTab&&r.a.createElement(Q.Root,{activeView:"latest"},r.a.createElement(Q.View,{id:"latest",activePanel:"latest"},r.a.createElement(Q.Panel,{id:"latest"},r.a.createElement(We,{go:this.go,type:"popular",duration:this.state.popularTab})))))),r.a.createElement(Q.View,{id:"search",activePanel:"search"},r.a.createElement(Q.Panel,{id:"search"},r.a.createElement(Q.PanelHeader,{noShadow:!0},"\u041f\u043e\u0438\u0441\u043a"),r.a.createElement(Ut,{go:this.go}))),r.a.createElement(Q.View,{id:"contests",activePanel:"contests"},r.a.createElement(Q.Panel,{id:"contests"},r.a.createElement(Q.PanelHeader,null,"\u041a\u043e\u043d\u043a\u0443\u0440\u0441\u044b"),r.a.createElement(zt,{go:this.go}))),r.a.createElement(Q.View,{id:"user",activePanel:"user"},r.a.createElement(Q.Panel,{id:"user"},r.a.createElement(Q.PanelHeader,null,"\u0418\u0432\u0430\u043d \u0418\u0432\u0430\u043d\u043e\u0432")))),r.a.createElement(Q.Root,{id:"modalPages",activeView:this.state.activeView},r.a.createElement(Q.View,{id:"postpage",activePanel:this.state.activePanel},r.a.createElement(Q.Panel,{id:"postpage"},r.a.createElement(Q.PanelHeader,{left:r.a.createElement(Q.HeaderButton,{onClick:this.returnTo},a===Q.IOS?r.a.createElement(ee.a,null):r.a.createElement(ne.a,null)),addon:r.a.createElement(Q.HeaderButton,{onClick:this.returnTo},"\u041d\u0430\u0437\u0430\u0434")},this.state.headerModalTitle),r.a.createElement(Nn,{fetchedUser:n,postId:this.state.postId,go:this.go}))),r.a.createElement(Q.View,{id:"contestpage",activePanel:this.state.activePanel},r.a.createElement(Q.Panel,{id:"contestpage"},r.a.createElement(Q.PanelHeader,{left:r.a.createElement(Q.HeaderButton,{onClick:this.returnTo},a===Q.IOS?r.a.createElement(ee.a,null):r.a.createElement(ne.a,null)),addon:r.a.createElement(Q.HeaderButton,{onClick:this.returnTo},"\u041d\u0430\u0437\u0430\u0434")},this.state.headerModalTitle),r.a.createElement(Wn,{fetchedUser:n,contestSlug:this.state.contestSlug,contestId:this.state.contestId,go:this.go}))),r.a.createElement(Q.View,{id:"userpage",activePanel:this.state.activePanel},r.a.createElement(Q.Panel,{id:"userpage"},r.a.createElement(Q.PanelHeader,{left:r.a.createElement(Q.HeaderButton,{onClick:this.returnTo},a===Q.IOS?r.a.createElement(ee.a,null):r.a.createElement(ne.a,null)),addon:r.a.createElement(Q.HeaderButton,{onClick:this.returnTo},"\u041d\u0430\u0437\u0430\u0434")},this.state.headerModalTitle),r.a.createElement(fa,{fetchedUser:n,username:this.state.username,userId:this.state.userId,go:this.go,replaceFeed:!0})))))}}]),t}(r.a.Component);K.a.send("VKWebAppInit",{});var va=Object(i.d)(G,Object(i.a)(c.a));o.a.render(r.a.createElement(l.a,{store:va},r.a.createElement(ha,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/ryfmaVKApp",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/ryfmaVKApp","/service-worker.js");q?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):B(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):B(e)})}}()}},[[176,2,1]]]);
//# sourceMappingURL=main.1f5a7523.chunk.js.map