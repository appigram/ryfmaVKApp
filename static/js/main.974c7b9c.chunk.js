(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},156:function(e,t,n){e.exports=n(311)},300:function(e,t,n){},308:function(e,t,n){},311:function(e,t,n){"use strict";n.r(t);n(157),n(181);var a=n(0),r=n.n(a),s=n(61),o=n.n(s),i=n(19),l=n(22),c=n(149),u=n(34),m=n(7),p=function(e){return{PENDING:"".concat(e,"_PENDING"),SUCCESS:"".concat(e,"_SUCCESS"),ERROR:"".concat(e,"_ERROR")}},d=p("GET_POSTS"),g=p("GET_POSTS_CONTENTS"),f={posts:[],postInfo:null,isPendingPosts:!1,isPendingContentsPostInfo:!1,error:""},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case d.PENDING:return Object(m.a)({},e,{posts:t.replaceFeed?[]:e.posts,error:"",isPendingPosts:!0});case d.SUCCESS:return Object(m.a)({},e,{posts:t.replaceFeed?t.payload:[].concat(Object(u.a)(e.posts),Object(u.a)(t.payload)),error:"",isPendingPosts:!1});case d.ERROR:return Object(m.a)({},e,{posts:[],error:t.payload,isPendingPosts:!1});case g.PENDING:return Object(m.a)({},e,{error:"",isPendingContentsPostInfo:!0});case g.SUCCESS:return Object(m.a)({},e,{postInfo:t.payload,error:"",isPendingContentsPostInfo:!1});case g.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingContentsPostInfo:!1});default:return e}},v=p("SEARCH_POSTS"),y=p("SEARCH_USERS"),b=p("SEARCH_TAGS"),E={posts:[],users:[],tags:[],isPendingPosts:!1,isPendingUsers:!1,isPendingTags:!1,keyword:"",error:""},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case v.PENDING:return Object(m.a)({},e,{posts:[],error:"",isPendingPosts:!0});case v.SUCCESS:return Object(m.a)({},e,{posts:t.payload,keyword:t.keyword,error:"",isPendingPosts:!1});case v.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingPosts:!1});case y.PENDING:return Object(m.a)({},e,{error:"",isPendingUsers:!0});case y.SUCCESS:return Object(m.a)({},e,{users:t.payload,keyword:t.keyword,error:"",isPendingUsers:!1});case y.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingUsers:!1});case b.PENDING:return Object(m.a)({},e,{error:"",isPendingTags:!0});case b.SUCCESS:return Object(m.a)({},e,{tags:t.payload,keyword:t.keyword,error:"",isPendingTags:!1});case b.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingTags:!1});default:return e}},I=p("GET_USER_INFO"),P=p("GET_USER_POSTS"),S=p("GET_FOLLOWERS"),O=p("GET_FOLLOWING"),w=p("GET_PAID_USERS"),C=(p("FOLLOW"),p("UNFOLLOW"),{user:null,posts:[],followers:[],following:[],paidUsers:[],isPendingUser:!1,isPendingPosts:!1,isPendingFollowers:!1,isPendingFollowing:!1,isPendingPaidUsers:!1,error:""}),T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case I.PENDING:return Object(m.a)({},e,{user:{},error:"",isPendingUser:!0});case I.SUCCESS:return Object(m.a)({},e,{user:t.payload,error:"",isPendingUser:!1});case I.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingUser:!1});case P.PENDING:return Object(m.a)({},e,{posts:[],error:"",isPendingPosts:!0});case P.SUCCESS:return Object(m.a)({},e,{posts:t.payload,error:"",isPendingPosts:!1});case P.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingPosts:!1});case S.PENDING:return Object(m.a)({},e,{error:"",isPendingFollowers:!0});case S.SUCCESS:return Object(m.a)({},e,{followers:t.payload,error:"",isPendingFollowers:!1});case S.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingFollowers:!1});case O.PENDING:return Object(m.a)({},e,{error:"",isPendingFollowing:!0});case O.SUCCESS:return Object(m.a)({},e,{following:t.payload,error:"",isPendingFollowing:!1});case O.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingFollowing:!1});case w.PENDING:return Object(m.a)({},e,{error:"",isPendingPaidUsers:!0});case w.SUCCESS:return Object(m.a)({},e,{paidUsers:t.payload,error:"",isPendingPaidUsers:!1});case w.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingPaidUsers:!1});default:return e}},j=p("GET_CONTESTS"),$=p("GET_CONTEST_INFO"),_=p("GET_CONTEST_POSTS"),U={contestInfo:null,contests:[],isPendingContest:!1,isPendingContests:!1,isPendingContestPosts:!1,error:""},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case j.PENDING:return Object(m.a)({},e,{contests:[],error:"",isPendingContests:!0});case j.SUCCESS:return Object(m.a)({},e,{contests:t.payload,error:"",isPendingContests:!1});case j.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingContests:!1});case $.PENDING:return Object(m.a)({},e,{contestInfo:{},error:"",isPendingContest:!0});case $.SUCCESS:return console.log("action:",t),Object(m.a)({},e,{contestInfo:t.payload,error:"",isPendingContest:!1});case $.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingContest:!1});case _.PENDING:return Object(m.a)({},e,{contestPosts:[],error:"",isPendingContestPosts:!0});case _.SUCCESS:return console.log("action:",t),Object(m.a)({},e,{contestPosts:t.payload,error:"",isPendingContestPosts:!1});case _.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingContestPosts:!1});default:return e}},R=p("GET_COMMENTS"),D=p("CREATE_COMMENT"),F=p("UPDATE_COMMENT"),x=p("DELETE_COMMENT"),L={comments:[],isPendingComments:!1,error:""},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case R.PENDING:return Object(m.a)({},e,{comments:[],error:"",isPendingComments:!0});case R.SUCCESS:return Object(m.a)({},e,{comments:[].concat(Object(u.a)(t.payload),Object(u.a)(e.comments)),error:"",isPendingComments:!1});case R.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingComments:!1});case D.PENDING:return Object(m.a)({},e,{error:""});case D.SUCCESS:return Object(m.a)({},e,{comments:[].concat(Object(u.a)(t.payload),Object(u.a)(e.comments)),error:""});case D.ERROR:return Object(m.a)({},e,{error:t.payload});case F.PENDING:return Object(m.a)({},e,{error:""});case F.SUCCESS:return Object(m.a)({},e,{comments:t.payload,error:""});case F.ERROR:return Object(m.a)({},e,{error:t.payload});case x.PENDING:return Object(m.a)({},e,{error:""});case x.SUCCESS:return Object(m.a)({},e,{comments:t.payload,error:""});case x.ERROR:return Object(m.a)({},e,{error:t.payload});default:return e}},M=p("GET_POPULAR_TAGS"),G=p("CREATE_TAG"),B=p("DELETE_TAG"),q={popularTags:[],isPendingPopularTags:!1,error:""},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case M.PENDING:return Object(m.a)({},e,{popularTags:[],error:"",isPendingPopularTags:!0});case M.SUCCESS:return Object(m.a)({},e,{popularTags:[].concat(Object(u.a)(t.payload),Object(u.a)(e.popularTags)),error:"",isPendingPopularTags:!1});case M.ERROR:return Object(m.a)({},e,{error:t.payload,isPendingPopularTags:!1});case G.PENDING:return Object(m.a)({},e,{error:""});case G.SUCCESS:return Object(m.a)({},e,{popularTags:[].concat(Object(u.a)(t.payload),Object(u.a)(e.popularTags)),error:""});case G.ERROR:return Object(m.a)({},e,{error:t.payload});case B.PENDING:return Object(m.a)({},e,{error:""});case B.SUCCESS:return Object(m.a)({},e,{popularTags:t.payload,error:""});case B.ERROR:return Object(m.a)({},e,{error:t.payload});default:return e}},V=Object(i.c)({posts:h,search:k,users:T,contests:N,comments:A,tags:z}),H=function(e,t){return V(e,t)};function W(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=n(11),K=n(12),Q=n(15),Z=n(14),X=n(16),ee=n(63),te=n.n(ee),ne=n(2),ae=function(){function e(){Object(J.a)(this,e)}return Object(K.a)(e,null,[{key:"setItem",value:function(e,t){sessionStorage.setItem(e,JSON.stringify(t))}},{key:"getItem",value:function(e){return sessionStorage.getItem(e)}},{key:"clear",value:function(){sessionStorage.clear()}}]),e}(),re=(n(191),n(71)),se=n.n(re),oe=n(72),ie=n.n(oe),le=n(150),ce=n.n(le),ue=n(151),me=n.n(ue),pe=(n(193),n(152)),de=n.n(pe),ge=(n(194),n(245)),fe=n(198),he=n(17),ve=(n(199),n(317)),ye=n(244),be=n(200),Ee=n.n(be),ke=new ve.a({dataIdFromObject:function(e){return e.__typename&&void 0!==e.id?"".concat(e.__typename,":").concat(e.id):null},addTypename:!0,cacheRedirects:{Query:{}}}),Ie=Object(fe.a)().concat(new ge.a({uri:"https://ryfma.com/graphql"})),Pe=new he.ApolloLink(function(e,t){var n=Ee.a.getLoginToken();return e.setContext({headers:{"meteor-login-token":n},http:{includeExtensions:!0,includeQuery:!1}}),t(e)}).concat(Ie),Se=(console.log,new ye.a({link:he.ApolloLink.from([].concat([Pe])),cache:ke})),Oe=n(10),we=n(8),Ce=n.n(we);function Te(){var e=Object(Oe.a)(["\n  mutation updatePost(\n    $_id: ID!,\n    $title: String!,\n    $slug: String!,\n    $htmlBody:  String!,\n    $excerpt: String!,\n    $paymentType: Int,\n    $coins: Int,\n    $status: String!,\n    $sticky: Boolean,\n    $coverImg: String,\n    $videoLink: String,\n    $tags: [String]!,\n    $albumId: String,\n    $oldAlbumId: String,\n    $isFromRyfmaBlog: Boolean\n    $isAdultContent: Boolean\n    $isCertified: Boolean\n  ) {\n    updatePost(\n      _id: $_id,\n      title: $title,\n      slug: $slug,\n      htmlBody: $htmlBody,\n      excerpt: $excerpt,\n      paymentType: $paymentType,\n      coins: $coins,\n      status: $status,\n      sticky: $sticky,\n      coverImg: $coverImg,\n      videoLink: $videoLink,\n      tags: $tags,\n      albumId: $albumId,\n      oldAlbumId: $oldAlbumId,\n      isFromRyfmaBlog: $isFromRyfmaBlog,\n      isCertified: $isCertified,\n      isAdultContent: $isAdultContent\n    )\n  }\n"]);return Te=function(){return e},e}function je(){var e=Object(Oe.a)(["\n  mutation deletePost($_id: ID!) {\n    deletePost(\n      _id: $_id\n    )\n  }\n"]);return je=function(){return e},e}function $e(){var e=Object(Oe.a)(["\n  mutation insertPost(\n    $title: String!,\n    $slug: String!,\n    $htmlBody:  String!,\n    $excerpt: String!,\n    $paymentType: Int,\n    $coins: Int,\n    $status: String!,\n    $sticky: Boolean,\n    $coverImg: String,\n    $videoLink: String,\n    $tags: [String]!,\n    $albumId: String,\n    $isFromRyfmaBlog: Boolean\n    $isCertified: Boolean\n    $isAdultContent: Boolean\n  ) {\n    insertPost(\n      title: $title,\n      slug: $slug,\n      htmlBody: $htmlBody,\n      paymentType: $paymentType,\n      coins: $coins,\n      excerpt: $excerpt,\n      status: $status,\n      sticky: $sticky,\n      coverImg: $coverImg,\n      videoLink: $videoLink,\n      tags: $tags,\n      albumId: $albumId,\n      isFromRyfmaBlog: $isFromRyfmaBlog,\n      isCertified: $isCertified,\n      isAdultContent: $isAdultContent\n    ){\n      _id\n    }\n  }\n"]);return $e=function(){return e},e}function _e(){var e=Object(Oe.a)(["\n  query getPostLikers($postId: ID!, $festId: String, $skip: Int, $limit: Int) {\n    getPostLikers(postId: $postId, festId: $festId, skip: $skip, limit: $limit)\n  }\n"]);return _e=function(){return e},e}function Ue(){var e=Object(Oe.a)(["\n  query getRelatedPosts($postId: ID!, $tags: [String]) {\n    relatedPosts(postId: $postId, tags: $tags) {\n      _id\n      createdAt\n      postedAt\n      title\n      coverImg\n      slug\n      excerpt\n      tags {\n        _id\n        name\n        slug\n      }\n      author {\n        _id\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return Ue=function(){return e},e}function Ne(){var e=Object(Oe.a)(["\n  mutation followUser($_id: ID!) {\n    followUser(\n      _id: $_id\n    )\n  }\n"]);return Ne=function(){return e},e}function Re(){var e=Object(Oe.a)(["\n  mutation allowAdultContent {\n    allowAdultContent\n  }\n"]);return Re=function(){return e},e}function De(){var e=Object(Oe.a)(["\n  mutation increasePostViewCount($_id: ID!) {\n    increasePostViewCount(_id: $_id)\n  }\n"]);return De=function(){return e},e}function Fe(){var e=Object(Oe.a)(["\n  mutation savePost($_id: ID!, $title: String!, $userId: String!) {\n    savePost(_id: $_id, title: $title, userId: $userId)\n  }\n"]);return Fe=function(){return e},e}function xe(){var e=Object(Oe.a)(["\n  mutation unSavePost($_id: ID!, $userId: String!) {\n    unSavePost(_id: $_id, userId: $userId)\n  }\n"]);return xe=function(){return e},e}function Le(){var e=Object(Oe.a)(["\n  mutation likePost(\n    $_id: ID!\n    $title: String!\n    $userId: String!\n    $likes: Int!\n    $totalLikes: Int!\n  ) {\n    likePost(\n      _id: $_id\n      title: $title\n      userId: $userId\n      likes: $likes\n      totalLikes: $totalLikes\n    )\n  }\n"]);return Le=function(){return e},e}function Ae(){var e=Object(Oe.a)(["\n  query getPromotion {\n    getPromotion {\n      _id\n      totalViews\n      currentViews\n      post {\n        _id\n        createdAt\n        postedAt\n        title\n        slug\n        excerpt\n        coverImg\n        videoLink\n        author {\n          _id\n          username\n          roles\n          isFollowing\n          emails {\n            verified\n          }\n          profile {\n            name\n            image\n          }\n        }\n      }\n    }\n  }\n"]);return Ae=function(){return e},e}function Me(){var e=Object(Oe.a)(["\n  query getPostInfo($postId: ID!) {\n    getPost(postId: $postId) {\n      _id\n      createdAt\n      postedAt\n      title\n      slug\n      excerpt\n      htmlBody\n      likeCount\n      liked\n      currUserLikes\n      viewCount\n      savedCount\n      saved\n      commentsCount\n      userId\n      coverImg\n      videoLink\n      fests\n      paymentType\n      coins\n      isBought\n      isCertified\n      isAdultContent\n      album {\n        _id\n        title\n        slug\n      }\n      tags {\n        _id\n        name\n        slug\n      }\n      author {\n        _id\n        username\n        isFollowing\n        coins\n        roles\n        emails {\n          verified\n        }\n        profile {\n          name\n          image\n          twitterUser\n        }\n      }\n    }\n  }\n"]);return Me=function(){return e},e}function Ge(){var e=Object(Oe.a)(["\n  query getPostData($postId: ID!) {\n    getPost(postId: $postId) {\n      _id\n      postedAt\n      title\n      slug\n      htmlBody\n      excerpt\n      paymentType\n      coins\n      viewCount\n      lastCommentedAt\n      clickCount\n      status\n      sticky\n      userId\n      coverImg\n      videoLink\n      videoId\n      tags {\n        _id\n        name\n      }\n      fests\n      albumId\n      isCertified\n      isAdultContent\n      isFromRyfmaBlog\n    }\n  }\n"]);return Ge=function(){return e},e}function Be(){var e=Object(Oe.a)(["\nquery getLatestPosts($type: String, $userId: String, $albumId: String, $tagId: String, $festId: String, $duration: String, $withImage: Boolean, $personal: Boolean, $keyword: String, $skip: Int, $limit: Int) {\n  posts(type: $type, userId: $userId, albumId: $albumId, tagId: $tagId, festId: $festId, duration: $duration, withImage: $withImage, personal: $personal, keyword: $keyword, skip: $skip, limit: $limit) {\n    _id\n    createdAt\n    postedAt\n    title\n    slug\n    excerpt\n    coverImg\n    videoLink\n    isAdultContent\n    paymentType\n    coins\n    isBought\n    isPromoted\n    isFromRyfmaBlog\n    promo {\n      currentViews\n    }\n    author {\n      _id\n      username\n      roles\n      isFollowing\n      emails {\n        verified\n      }\n      profile {\n        name\n        image\n      }\n    }\n  }\n}\n"]);return Be=function(){return e},e}var qe=Ce()(Be()),ze=(Ce()(Ge()),Ce()(Me())),Ve=(Ce()(Ae()),Ce()(Le())),He=(Ce()(xe()),Ce()(Fe()),Ce()(De()),Ce()(Re()),Ce()(Ne()),Ce()(Ue()),Ce()(_e()),Ce()($e()),Ce()(je()),Ce()(Te()),function(e){var t=e.type,n=e.userId,a=e.albumId,r=e.tagId,s=e.festId,o=e.withImage,i=e.duration,l=e.personal,c=e.keyword,u=e.skip,m=e.limit,p=e.force,g=e.replaceFeed;return function(e,f){return console.log("New action!"),console.log("replaceFeed: ",g),e({type:d.PENDING,replaceFeed:g}),Se.query({query:qe,variables:{type:t,userId:n,albumId:a,tagId:r,festId:s,withImage:o,duration:i,personal:l,keyword:c,skip:u,limit:m},fetchPolicy:p?"network-only":"cache-first"}).then(function(t){e({type:d.SUCCESS,payload:t.data.posts,replaceFeed:g,error:""})}).catch(function(t){e({type:d.ERROR,payload:t.message})})}}),We=function(e){var t=e.postId;return function(e,n){return e({type:g.PENDING}),Se.query({skip:!t,query:ze,variables:{postId:t}}).then(function(t){e({type:g.SUCCESS,payload:t.data.getPost})}).catch(function(t){e({type:g.ERROR,payload:t.message})})}},Ye=function(e){function t(){return Object(J.a)(this,t),Object(Q.a)(this,Object(Z.a)(t).apply(this,arguments))}return Object(X.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){return r.a.createElement(ne.Spinner,null)}}]),t}(a.Component),Je=(n(145),function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).state={},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this.props.post;if(!e.author)return null;var t=e.excerpt;return r.a.createElement(ne.Group,{id:e._id,className:"post-list-item"},r.a.createElement(ne.Cell,{size:"l",description:"\u043e\u0442 "+e.author.profile.name,before:r.a.createElement(ne.Avatar,{size:36,src:e.author.profile.image}),onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},e.title),r.a.createElement(ne.Div,{className:"content",onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},e.coverImg&&r.a.createElement(ne.Avatar,{type:"image",src:e.coverImg,className:"post-image"}),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})),r.a.createElement(ne.Cell,{onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},r.a.createElement(ne.Link,{onClick:this.goToPost},"\u0427\u0438\u0442\u0430\u0442\u044c \u0434\u0430\u043b\u0435\u0435")))}}]),t}(a.Component)),Ke=function(e){e.goToFunc;return r.a.createElement(ne.Group,null,r.a.createElement(ne.Cell,null,"\u041b\u0435\u043d\u0442\u0430 \u043f\u0443\u0441\u0442\u0430"))},Qe=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).fetchMorePosts=function(e){e.type;var t=e.duration,a=e.replaceFeed,r=e.skip;return function(){var e=n.props,s=e.type,o=e.userId,i=e.albumId,l=e.tagId,c=e.festId,u=e.withImage,m=e.personal,p=e.keyword,d=e.limit;n.props.getPosts({type:s,userId:o,albumId:i,tagId:l,festId:c,withImage:u,duration:t,personal:m,keyword:p,force:!0,replaceFeed:a,skip:r,limit:d}),s&&n.setState({activeType:s}),t&&n.setState({activeDuration:t})}},n.state={posts:[],activeType:"latest",activeDuration:"day",lastType:e.type,duration:e.duration},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),console.log("props: ",this.props);var e=this.props,t=e.type,n=e.userId,a=e.albumId,r=e.tagId,s=e.festId,o=e.withImage,i=e.duration,l=e.personal,c=e.keyword,u=e.skip,m=e.limit,p=e.force,d=e.replaceFeed;this.props.getPosts({type:t,userId:n,albumId:a,tagId:r,festId:s,withImage:o,duration:i,personal:l,keyword:c,skip:u,limit:m,force:p,replaceFeed:d})}},{key:"render",value:function(){var e=this,t=this.props,n=t.posts,a=t.isPendingPosts,s=t.type,o=t.userId,i=t.personal,l=t.subTitle,c=r.a.createElement(ne.Group,null,r.a.createElement(ne.Tabs,{type:"buttons"},r.a.createElement(ne.HorizontalScroll,null,r.a.createElement(ne.TabsItem,{onClick:this.fetchMorePosts({type:"latest",replaceFeed:!0,skip:0}),selected:"latest"===this.state.activeType},"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435"),r.a.createElement(ne.TabsItem,{onClick:this.fetchMorePosts({type:"popular",replaceFeed:!0,skip:0}),selected:"popular"===this.state.activeType},"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435"),r.a.createElement(ne.TabsItem,{onClick:this.fetchMorePosts({type:"viewed",replaceFeed:!0,skip:0}),selected:"viewed"===this.state.activeType},"\u0427\u0438\u0442\u0430\u0435\u043c\u044b\u0435"),r.a.createElement(ne.TabsItem,{onClick:this.fetchMorePosts({type:"commented",replaceFeed:!0,skip:0}),selected:"commented"===this.state.activeType},"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0435\u043c\u044b\u0435")))),u=r.a.createElement(ne.Tabs,{theme:"light"},r.a.createElement(ne.TabsItem,{onClick:this.fetchMorePosts({type:"popular",duration:"day",replaceFeed:!0}),selected:"day"===this.state.activeDuration},"\u0417\u0430 \u0434\u0435\u043d\u044c"),r.a.createElement(ne.TabsItem,{onClick:this.fetchMorePosts({type:"popular",duration:"week",replaceFeed:!0}),selected:"week"===this.state.activeDuration},"\u0417\u0430 \u043d\u0435\u0434\u0435\u043b\u044e"),r.a.createElement(ne.TabsItem,{onClick:this.fetchMorePosts({type:"popular",duration:"month",replaceFeed:!0}),selected:"month"===this.state.activeDuration},"\u0417\u0430 \u043c\u0435\u0441\u044f\u0446"));return r.a.createElement(ne.Group,{title:l||""},"popular"===s&&u,o&&i&&c,(!n||0===n.length)&&r.a.createElement(Ke,null),a&&r.a.createElement(Ye,null),r.a.createElement(ne.List,null,n.map(function(t){return r.a.createElement(Je,{key:t._id,post:t,go:e.props.go})}),r.a.createElement(ne.Div,null,r.a.createElement(ne.Button,{size:"xl",level:"secondary",onClick:this.fetchMorePosts({activeTab:this.state.activeTab,replaceFeed:!1,skip:this.state.posts.length})},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))}}]),t}(a.Component);var Ze=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{posts:e.posts.posts,isPendingPosts:e.posts.isPendingPosts}},function(e){return Object(i.b)({getPosts:He},e)})(Qe);function Xe(){var e=Object(Oe.a)(["\n  query searchTags($keyword: String!) {\n    searchTags(\n      keyword: $keyword\n    ) {\n      name\n      count\n    }\n  }\n"]);return Xe=function(){return e},e}function et(){var e=Object(Oe.a)(["\n  query searchTags($keyword: String!) {\n    searchTags(\n      keyword: $keyword\n    ) {\n      name\n    }\n  }\n"]);return et=function(){return e},e}function tt(){var e=Object(Oe.a)(["\n  query searchUsers($keyword: String!, $limit: Int) {\n    searchUsers(keyword: $keyword, limit: $limit) {\n      _id\n      username\n      isFollowing\n      roles\n      profile {\n        name\n        bio\n        image\n      }\n    }\n  }\n"]);return tt=function(){return e},e}function nt(){var e=Object(Oe.a)(["\n  query searchUsers($keyword: String!) {\n    searchUsers(keyword: $keyword) {\n      _id\n      username\n      profile {\n        name\n        image\n      }\n    }\n  }\n"]);return nt=function(){return e},e}function at(){var e=Object(Oe.a)(["\n  query searchPosts($keyword: String!, $limit: Int) {\n    searchPosts(keyword: $keyword, limit: $limit) {\n      _id\n      createdAt\n      title\n      slug\n      htmlBody\n      excerpt\n      viewCount\n      lastCommentedAt\n      clickCount\n      status\n      sticky\n      userId\n      coverImg\n      author {\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return at=function(){return e},e}function rt(){var e=Object(Oe.a)(["\n  query searchPosts($keyword: String!) {\n    searchPosts(\n      keyword: $keyword\n    ) {\n      _id\n      title\n      coverImg\n    }\n  }\n"]);return rt=function(){return e},e}Ce()(rt());var st=Ce()(at()),ot=(Ce()(nt()),Ce()(tt()));Ce()(et()),Ce()(Xe());function it(){var e=Object(Oe.a)(["\n  mutation createPayout($payoutType: Int!, $totalSum: Int!, $status: Int!, $comment: String) {\n    createPayout (\n      payoutType: $payoutType,\n      totalSum: $totalSum,\n      status: $status,\n      comment: $comment\n    )\n  }\n"]);return it=function(){return e},e}function lt(){var e=Object(Oe.a)(["\n  mutation createDeposit($depositType: Int!, $totalSum: Int!, $status: Int!, $comment: String) {\n    createDeposit (\n      depositType: $depositType,\n      totalSum: $totalSum,\n      status: $status,\n      comment: $comment\n    )\n  }\n"]);return lt=function(){return e},e}function ct(){var e=Object(Oe.a)(["\n  mutation checkIfEmailExists($email: String!) {\n    checkIfEmailExists(\n      email: $email\n    )\n  }\n"]);return ct=function(){return e},e}function ut(){var e=Object(Oe.a)(["\n  mutation checkIfUsernameExists($username: String!) {\n    checkIfUsernameExists(\n      username: $username\n    )\n  }\n"]);return ut=function(){return e},e}function mt(){var e=Object(Oe.a)(["\n  mutation unFollowUser($_id: ID!) {\n    unFollowUser(\n      _id: $_id\n    )\n  }\n"]);return mt=function(){return e},e}function pt(){var e=Object(Oe.a)(["\n  mutation followUser($_id: ID!) {\n    followUser(\n      _id: $_id\n    )\n  }\n"]);return pt=function(){return e},e}function dt(){var e=Object(Oe.a)(["\n  mutation changeUserAvatar(\n    $avatarUrl: String!,\n  ) {\n    changeUserAvatar(\n      avatarUrl: $avatarUrl,\n    )\n  }\n"]);return dt=function(){return e},e}function gt(){var e=Object(Oe.a)(["\n  mutation saveSettings(\n    $username: String,\n    $email: String,\n    $password: String\n  ) {\n    saveSettings(\n      username: $username,\n      email: $email,\n      password: $password,\n    )\n  }\n"]);return gt=function(){return e},e}function ft(){var e=Object(Oe.a)(["\n  mutation saveProfile(\n    $firstname: String,\n    $lastname: String,\n    $gender: String,\n    $birthday: String,\n    $locationStr: String,\n    $bio: String,\n  ) {\n    saveProfile(\n      firstname: $firstname,\n      lastname: $lastname,\n      gender: $gender,\n      birthday: $birthday,\n      locationStr: $locationStr,\n      bio: $bio,\n    )\n  }\n"]);return ft=function(){return e},e}function ht(){var e=Object(Oe.a)(["\n  query getSaved($sortType: String, $userId: String, $albumId: String, $tagId: String) {\n    getSaved(sortType: $sortType, userId: $userId, albumId: $albumId, tagId: $tagId) {\n      _id\n      createdAt\n      title\n      slug\n      excerpt\n      coverImg\n      author {\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return ht=function(){return e},e}function vt(){var e=Object(Oe.a)(["\n  query getFollowing($username: String!, $skip: Int, $limit: Int) {\n    getFollowing(username: $username, skip: $skip, limit: $limit) {\n      _id\n      username\n      isFollowing\n      roles\n      coins\n      profile {\n        name\n        bio\n        image\n      }\n    }\n  }\n"]);return vt=function(){return e},e}function yt(){var e=Object(Oe.a)(["\n  query getFollowers($username: String!, $skip: Int, $limit: Int) {\n    getFollowers(username: $username, skip: $skip, limit: $limit) {\n      _id\n      username\n      isFollowing\n      roles\n      coins\n      profile {\n        name\n        bio\n        image\n      }\n    }\n  }\n"]);return yt=function(){return e},e}function bt(){var e=Object(Oe.a)(["\n  query getPaidUsersFull ($duration: Int, $limit: Int) {\n    getPaidUsersFull (duration: $duration, limit: $limit) {\n      _id\n      username\n      roles\n      isFollowing\n      emails {\n        verified\n      }\n      profile {\n        name\n        image\n        bio\n      }\n      stats {\n        postsCount\n        followersCount\n      }\n    }\n  }\n"]);return bt=function(){return e},e}function Et(){var e=Object(Oe.a)(["\n  query getUser($username: String!) {\n    getUser(username: $username) {\n      _id\n      username\n      isFollowing\n      roles\n      coins\n      emails {\n        verified\n      }\n      roomId\n      isClassic\n      tariffs\n      currency\n      profile {\n        name\n        firstname\n        lastname\n        bio\n        city\n        website\n        twitterUser\n        instagramUser\n        vkUser\n        facebookUser\n        invitesCount\n        image\n        karma\n        badges {\n          url\n          image\n          desc\n        }\n      }\n      stats {\n        postsCount\n        albumsCount\n        booksCount\n        followersCount\n        followingCount\n        bookshelvesCount\n        savedCount\n        strikeCount\n        strikePostsCount\n        levitanDownloads\n      }\n    }\n  }\n"]);return Et=function(){return e},e}function kt(){var e=Object(Oe.a)(["\n  query getCurrentUser {\n    me {\n      _id\n      username\n      roles\n      coins\n      rooms\n      emails {\n        address\n        verified\n      }\n      profile {\n        name\n        firstname\n        lastname\n        gender\n        birthday\n        locationStr\n        unreadNotifications\n        image\n        bio\n      }\n      stats {\n        postsCount\n        followersCount\n        followingCount\n        sellingCount\n        soldCount\n        boughtCount\n      }\n    }\n  }\n"]);return kt=function(){return e},e}Ce()(kt());var It=Ce()(Et()),Pt=Ce()(bt()),St=(Ce()(yt()),Ce()(vt()),Ce()(ht()),Ce()(ft()),Ce()(gt()),Ce()(dt()),Ce()(pt()),Ce()(mt()),Ce()(ut()),Ce()(ct()),Ce()(lt()),Ce()(it()),function(e){var t=e.keyword,n=e.skip,a=e.limit;return function(e,r){return e({type:v.PENDING}),console.log("searchPosts: ",t),Se.query({query:st,variables:{keyword:t,skip:n,limit:a}}).then(function(n){e({type:v.SUCCESS,payload:n.data.searchPosts,keyword:t,error:""})}).catch(function(t){e({type:v.ERROR,payload:t.message})})}}),Ot=function(e){var t=e.keyword,n=e.skip,a=e.limit;return function(e,r){return e({type:y.PENDING}),console.log("searchUsers: ",t),Se.query({query:ot,variables:{keyword:t,skip:n,limit:a}}).then(function(n){e({type:y.SUCCESS,payload:n.data.searchUsers,keyword:t,error:""})}).catch(function(t){e({type:y.ERROR,payload:t.message})})}},wt=function(e){var t=e.username,n=e.force;return function(e,a){return e({type:I.PENDING}),Se.query({skip:!t,query:It,variables:{username:t},fetchPolicy:n?"network-only":"cache-first"}).then(function(t){e({type:I.SUCCESS,payload:t.data.getUser,error:""})}).catch(function(t){e({type:I.ERROR,payload:t.message})})}},Ct=function(e){var t=e.duration,n=e.skip,a=e.limit;return function(e,r){return e({type:w.PENDING}),Se.query({query:Pt,variables:{duration:t,skip:n,limit:a}}).then(function(t){e({type:w.SUCCESS,payload:t.data.getPaidUsersFull})}).catch(function(t){e({type:w.ERROR,payload:t.message})})}},Tt=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).goToUser=function(e){console.log("Go to user",n.props.user),console.log("Event data: ",e),n.props.go(e)},n.followUser=function(){},n.unFollowUser=function(){},n.state={},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this.props.user,t=e.profile.image||"https://cdn.ryfma.com/defaults/icons/default_full_avatar.jpg";return t.indexOf("_full_")>0?t=t.replace("_full_","_medium_"):t.indexOf("graph.facebook.com")>0&&(t=t.replace("=large","=square")),r.a.createElement(ne.Cell,{id:e._id,className:"user-info-item",before:r.a.createElement(ne.Avatar,{size:36,src:e.profile.image}),description:e.profile.bio,onClick:this.goToUser,"data-view":"userpage","data-panel":"userpage","data-userid":e._id,"data-username":e.username,"data-headertitle":e.profile.name},e.profile.name)}}]),t}(a.Component),jt=n(84),$t=n.n(jt),_t=n(218),Ut=n.n(_t),Nt=n(219),Rt=n.n(Nt),Dt=(n(104),function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).goToUser=function(){},n.followUser=function(){},n.unFollowUser=function(){},n.state={},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this.props.user,t=e.profile.image||"https://cdn.ryfma.com/defaults/icons/default_full_avatar.jpg";t.indexOf("_full_")>0?t=t.replace("_full_","_medium_"):t.indexOf("graph.facebook.com")>0&&(t=t.replace("=large","=square"));var n=e.profile.bio||"";n=n.length>40?n.substr(0,40)+"...":n;var a=null;return a=e.isFollowing?r.a.createElement(ne.Button,{size:"l",className:"ui gray basic button follow",onClick:this.unFollowUser,style:{marginTop:8}},"\u041e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f"):r.a.createElement(ne.Button,{size:"l",className:"ui green button follow",onClick:this.followUser,style:{marginTop:8}},"\u0427\u0438\u0442\u0430\u0442\u044c"),a=null,r.a.createElement(ne.Div,{id:e._id,style:{textAlign:"center",marginTop:8},className:"user-info-item"},r.a.createElement(ne.Avatar,{size:80,src:e.profile.image,style:{margin:"0 auto"},onClick:this.props.go,"data-view":"userpage","data-panel":"userpage","data-userid":e._id,"data-username":e.username,"data-headertitle":e.profile.name},r.a.createElement($t.a,{fill:"#FFFFFF"})),r.a.createElement("h2",{style:{marginBottom:"8px"},onClick:this.props.go,"data-view":"userpage","data-panel":"userpage","data-userid":e._id,"data-username":e.username,"data-headertitle":e.profile.name},e.profile.name),r.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"12px"}},r.a.createElement("span",{style:{margin:"0 8px"}},r.a.createElement(Rt.a,null),e.stats.postsCount),r.a.createElement("span",{style:{margin:"0 8px"}},r.a.createElement(Ut.a,null),e.stats.followersCount)),r.a.createElement(ne.Cell,{multiline:!0},n),a)}}]),t}(a.Component)),Ft=function(e){e.goToFunc;return r.a.createElement(ne.Group,null,r.a.createElement(ne.Cell,null,"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441"))},xt=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).handleSearch=function(e,t){var a=t||n.state.activeTab;e&&("posts"===a?n.props.searchPosts({keyword:e,limit:24}):"users"===a&&n.props.searchUsers({keyword:e,limit:24}))},n.changeTab=function(e){return function(){var t=n.state.keyword;n.setState({activeTab:e}),n.handleSearch(t,e)}},n.onChange=function(e){var t=n.state.activeTab;n.setState({keyword:e}),n.handleSearch(e,t)},n.fetchMorePosts=function(e){var t=n.props.posts;n.props.searchPosts({skip:t.length,limit:15})},n.fetchMoreUsers=function(e){var t=n.props.users;n.props.searchUsers({skip:t.length,limit:15})},n.state={keyword:"",activeTab:"users",searchResult:[]},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),this.props.getPaidUsers({})}},{key:"render",value:function(){var e=this,t=this.props,n=t.posts,a=t.users,s=t.paidUsers,o=t.isPendingPosts,i=t.isPendingUsers,l=(t.isPendingPaidUsers,this.state),c=l.keyword,u=l.activeTab;return r.a.createElement("div",null,r.a.createElement(ne.FixedLayout,{vertical:"top"},r.a.createElement(ne.Search,{value:this.state.search,onChange:this.onChange})),!c&&r.a.createElement("div",{className:"paid-users",style:{marginTop:56}},r.a.createElement(ne.Group,{title:"\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f"},s.map(function(t){return r.a.createElement(Dt,{user:t,go:e.props.go})})),r.a.createElement("div",{className:"get-started-block"},r.a.createElement("h3",null,"\u041f\u0443\u0431\u043b\u0438\u043a\u0443\u0439 \u0441\u0432\u043e\u0435 \u0442\u0432\u043e\u0440\u0447\u0435\u0441\u0442\u0432\u043e"),r.a.createElement("p",null,"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u044f \u0441\u0432\u043e\u0438\u0445 \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u0439 \u043d\u0430 Ryfma \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u0430"),r.a.createElement(ne.Button,{size:"l"},"\u0414\u0430\u0432\u0430\u0439\u0442\u0435 \u043d\u0430\u0447\u043d\u0435\u043c"))),c&&r.a.createElement(ne.Tabs,{theme:"light",style:{marginTop:56}},r.a.createElement(ne.TabsItem,{onClick:this.changeTab("users"),selected:"users"===u},"\u0410\u0432\u0442\u043e\u0440\u044b"),r.a.createElement(ne.TabsItem,{onClick:this.changeTab("posts"),selected:"posts"===u},"\u041f\u043e\u0441\u0442\u044b")),(i||o)&&r.a.createElement(Ye,null),0===a.length&&"users"===u&&c&&r.a.createElement(Ft,null),0===n.length&&"posts"===u&&c&&r.a.createElement(Ft,null),a.length>0&&"users"===u&&r.a.createElement(ne.List,null,a.map(function(t){return r.a.createElement(ne.Div,{className:"user-info-wrapper"},r.a.createElement(Tt,{key:t._id,user:t,go:e.props.go}))}),r.a.createElement(ne.Div,null,r.a.createElement(ne.Button,{size:"xl",level:"secondary",onClick:this.fetchMoreUser},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))),n.length>0&&"posts"===u&&r.a.createElement(ne.List,null,n.map(function(t){return r.a.createElement(Je,{key:t._id,post:t,go:e.props.go})}),r.a.createElement(ne.Div,null,r.a.createElement(ne.Button,{size:"xl",level:"secondary",onClick:this.fetchMorePosts},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))}}]),t}(a.Component);var Lt=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{posts:e.search.posts,users:e.search.users,paidUsers:e.users.paidUsers,isPendingPosts:e.search.isPendingPosts,isPendingUsers:e.search.isPendingUsers,isPendingPaidUsers:e.users.isPendingPaidUsers}},function(e){return Object(i.b)({searchPosts:St,searchUsers:Ot,getPaidUsers:Ct},e)})(xt);function At(){var e=Object(Oe.a)(["\n  query getFestPosts($festId: String!, $keyword: String, $city: String, $filterType: String, $sortType: String, $level: Int, $skip: Int, $limit: Int) {\n    festPosts(festId: $festId, keyword: $keyword, city: $city, filterType: $filterType, sortType: $sortType, level: $level, skip: $skip, limit: $limit) {\n      _id\n      festId\n      postId\n      userId\n      city\n      likeCount\n\n      author {\n        _id\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n\n      post {\n        _id\n        createdAt\n        title\n        slug\n        excerpt\n        htmlBody\n        coverImg\n        likeCount\n        liked\n        currUserLikes\n        commentsCount\n        userId\n        isAdultContent\n      }\n\n      juryStats {\n        userId\n        rating\n      }\n\n      stats {\n        juryCount\n        juryAverage\n        juryTotal\n      }\n    }\n  }\n"]);return At=function(){return e},e}function Mt(){var e=Object(Oe.a)(["\n  query getContest($slug: String, $festId: String) {\n    getContest(slug: $slug, festId: $festId) {\n      _id\n      ownerId\n      seoTitle\n      title\n      slug\n      brief\n      description\n      fromDate\n      toDate\n      acceptDate\n      sticky\n      coverImg\n      genres\n      entryFee\n      vkGroupLink\n      vkEventLink\n      fbGroupLink\n      topPrize\n      extraPrize\n      noJury\n      isFestival\n      isDuel\n      countries\n      levels\n      currentLevel\n      author {\n        _id\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n      usersData {\n        _id\n        username\n        roles\n        profile {\n          image\n          name\n        }\n      }\n      cities {\n        name\n        coordinates\n        partners {\n          name\n          image\n          url\n        }\n      }\n      curatorsData {\n        _id\n        username\n        profile {\n          name\n          image\n          city\n          vkUser\n        }\n      }\n      juryData {\n        _id\n        username\n        roles\n        profile {\n          name\n          image\n        }\n      }\n      partners {\n        name\n        brief\n        logoLink\n        url\n        images\n      }\n      stats {\n        juryCount\n        countryCount\n        citiesCount\n        usersCount\n      }\n      comments {\n        _id\n        createdAt\n        postedAt\n        content\n        objectType\n        objectId\n        userId\n        author {\n          _id\n          username\n          roles\n          emails {\n            verified\n          }\n          profile {\n            name\n            image\n          }\n        }\n      }\n    }\n  }\n"]);return Mt=function(){return e},e}function Gt(){var e=Object(Oe.a)(["\n  query getFestivals(\n    $keyword: String,\n    $genreType: String,\n    $sortType: String,\n    $location: String,\n    $skip: Int,\n    $limit: Int\n    $isDuel: Boolean\n  ) {\n    getFestivals(\n      keyword: $keyword,\n      genreType: $genreType,\n      sortType: $sortType,\n      location: $location,\n      skip: $skip,\n      limit: $limit,\n      isDuel: $isDuel\n    ) {\n      _id\n      title\n      slug\n      brief\n      description\n      fromDate\n      toDate\n      sticky\n      coverImg\n      genres\n      entryFee\n      topPrize\n      extraPrize\n      countries\n      author {\n        _id\n        username\n        profile {\n          name\n          image\n        }\n      }\n      usersData {\n        _id\n        username\n        profile {\n          image\n        }\n      }\n      stats {\n        usersCount\n      }\n    }\n  }\n"]);return Gt=function(){return e},e}var Bt=Ce()(Gt()),qt=Ce()(Mt()),zt=Ce()(At()),Vt=function(e){var t=e.slug,n=e.festId;return function(e,a){return e({type:$.PENDING}),Se.query({query:qt,variables:{slug:t,festId:n}}).then(function(t){e({type:$.SUCCESS,payload:t.data.getContest,error:""})}).catch(function(t){e({type:$.ERROR,payload:t.message})})}},Ht=function(e){var t=e.keyword,n=e.genreType,a=e.sortType,r=e.location,s=e.skip,o=e.limit,i=e.isDuel;return function(e,l){return e({type:j.PENDING}),Se.query({query:Bt,variables:{keyword:t,genreType:n,sortType:a,location:r,skip:s,limit:o,isDuel:i}}).then(function(t){e({type:j.SUCCESS,payload:t.data.getFestivals,error:""})}).catch(function(t){e({type:j.ERROR,payload:t.message})})}},Wt=function(e){var t=e.festId,n=e.keyword,a=e.city,r=e.filterType,s=e.sortType,o=e.level,i=e.skip,l=e.limit;return function(e,c){return e({type:_.PENDING}),Se.query({query:zt,variables:{festId:t,keyword:n,city:a,filterType:r,sortType:s,level:o,skip:i,limit:l}}).then(function(t){e({type:_.SUCCESS,payload:t.data.festPosts,error:""})}).catch(function(t){e({type:_.ERROR,payload:t.message})})}},Yt=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).viewContest=function(){n.props.go()},n.state={},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this.props.contest,t=e.coverImg||"https://cdn.ryfma.com/defaults/icons/default_full_avatar.jpg";return r.a.createElement(ne.Div,{id:e._id,onClick:this.props.go,"data-view":"contestpage","data-panel":"contestpage","data-contestid":e._id,"data-contestslug":e.slug,"data-headertitle":e.title},r.a.createElement("img",{src:t,style:{width:"100%",borderRadius:"6px"}}),r.a.createElement("h1",{style:{marginBottom:0}},e.title),r.a.createElement("div",null,r.a.createElement(ne.Link,null,e.author.profile.name)),r.a.createElement("div",null,e.brief),r.a.createElement("div",{className:"paticipants",style:{display:"flex",alignItems:"center",margin:"12px 0",marginLeft:"12px"}},e.usersData[0]&&r.a.createElement(ne.Link,{key:e.usersData[0]._id,to:"/u/"+e.usersData[0].username,style:{marginLeft:"-12px"}},r.a.createElement(ne.Avatar,{size:32,src:e.usersData[0].profile.image?e.usersData[0].profile.image.replace("_full_","_small_"):null})),e.usersData[1]&&r.a.createElement(ne.Link,{key:e.usersData[1]._id,to:"/u/"+e.usersData[1].username,style:{marginLeft:"-12px"}},r.a.createElement(ne.Avatar,{size:32,src:e.usersData[1].profile.image?e.usersData[1].profile.image.replace("_full_","_small_"):null})),e.usersData[2]&&r.a.createElement(ne.Link,{key:e.usersData[2]._id,to:"/u/"+e.usersData[2].username,style:{marginLeft:"-12px"}},r.a.createElement(ne.Avatar,{size:32,src:e.usersData[2].profile.image?e.usersData[2].profile.image.replace("_full_","_small_"):null})),e.stats.usersCount>3?r.a.createElement("span",{style:{marginLeft:"8px"}},"+",e.stats.usersCount-3," \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"):0===e.stats.usersCount?r.a.createElement("span",{style:{marginLeft:"8px"}},"\u041d\u0435\u0442 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"):null),r.a.createElement(ne.Button,{size:"xl",style:{marginBottom:"24px"},onClick:this.props.go,"data-view":"contestpage","data-panel":"contestpage","data-contestid":e._id},"\u0423\u0437\u043d\u0430\u0442\u044c"))}}]),t}(a.Component),Jt=function(e){e.goToFunc;return r.a.createElement(ne.Group,null,r.a.createElement(ne.Cell,null,"\u041a\u043e\u043d\u043a\u0443\u0440\u0441\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"))},Kt=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).changeTab=function(e){return function(){var t=n.state.keyword;n.setState({activeTab:e}),n.handleSearch(t,e)}},n.fetchMoreContests=function(e){var t=n.props.contests;n.props.getFestivalsInfo({skip:t.length,limit:7})},n.state={keyword:"",activeTab:"users",searchResult:[]},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),this.props.getFestivalsInfo({genreType:"\u0412\u0441\u0435 \u0436\u0430\u043d\u0440\u044b",sortType:"mostPeople",location:"worldwide"})}},{key:"render",value:function(){var e=this,t=this.props,n=t.contests,a=t.isPendingContests,s=this.state,o=s.keyword;s.activeTab;return r.a.createElement(ne.Group,{title:"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u043a\u043e\u043d\u043a\u0443\u0440\u0441\u044b"},a&&r.a.createElement(Ye,null),0===n.length&&o&&r.a.createElement(Jt,null),n.length>0&&r.a.createElement(ne.List,null,n.map(function(t){return r.a.createElement(Yt,{key:t._id,contest:t,go:e.props.go})}),r.a.createElement(ne.Div,null,r.a.createElement(ne.Button,{size:"xl",level:"secondary",onClick:this.fetchMoreContests},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))}}]),t}(a.Component);var Qt=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{contests:e.contests.contests,isPendingContests:e.contests.isPendingContests}},function(e){return Object(i.b)({getFestivalsInfo:Ht},e)})(Kt),Zt=n(33),Xt=n.n(Zt),en=n(43),tn=n(62),nn=n.n(tn),an=n(36);function rn(){var e=Object(Oe.a)(["\n  mutation markCommentAsSpam($_id: ID!, $postUserId: String!, $commentUserId: String!, $spamScore: Int!) {\n    markCommentAsSpam(\n      _id: $_id,\n      postUserId: $postUserId,\n      commentUserId: $commentUserId,\n      spamScore: $spamScore\n    )\n  }\n"]);return rn=function(){return e},e}function sn(){var e=Object(Oe.a)(["\n  mutation deleteComment($_id: ID!, $userId: String!, $objectType: String!, $objectId: String!, $parentId: String) {\n    deleteComment(\n      _id: $_id,\n      userId: $userId,\n      objectType: $objectType,\n      objectId: $objectId,\n      parentId: $parentId\n    )\n  }\n"]);return sn=function(){return e},e}function on(){var e=Object(Oe.a)(["\n  mutation updateComment(\n    $_id: ID!,\n    $content: String!,\n    $objectType: String!,\n    $objectId: String!,\n    $parentId: String\n  ) {\n    updateComment(\n      _id: $_id,\n      content: $content,\n      objectType: $objectType,\n      objectId: $objectId,\n      parentId: $parentId\n    )\n  }\n"]);return on=function(){return e},e}function ln(){var e=Object(Oe.a)(["\n  mutation insertComment(\n    $content: String!,\n    $objectType: String!,\n    $objectId: String!,\n    $parentId: String,\n    $title: String!,\n    $userId: String!\n    $ratingCount: Int,\n    $currRating: Float,\n    $newRating: Int,\n  ) {\n    insertComment(\n      content: $content,\n      objectType: $objectType,\n      objectId: $objectId,\n      parentId: $parentId,\n      title: $title,\n      userId: $userId,\n      ratingCount: $ratingCount,\n      currRating: $currRating,\n      newRating: $newRating,\n    ){\n      _id\n      createdAt\n      postedAt\n      content\n      objectType\n      objectId\n      parentId\n      userId\n      author {\n        _id\n        username\n        emails {\n          verified\n        }\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return ln=function(){return e},e}function cn(){var e=Object(Oe.a)(["\n  query getComments($objectId: String!, $parentId: String, $festId: String,  $skip: Int, $limit: Int) {\n    getComments(objectId: $objectId, parentId: $parentId, festId: $festId,  skip: $skip, limit: $limit) {\n      _id\n      createdAt\n      postedAt\n      content\n      slug\n      objectType\n      objectId\n      parentId\n      userId\n      spamScore\n      author {\n        _id\n        username\n        roles\n        emails {\n          verified\n        }\n        profile {\n          name\n          image\n        }\n      }\n    }\n  }\n"]);return cn=function(){return e},e}var un=Ce()(cn()),mn=(Ce()(ln()),Ce()(on()),Ce()(sn()),Ce()(rn()),function(e){var t=e.objectId,n=e.parentId,a=e.festId,r=e.skip,s=e.limit;return function(e,o){return e({type:R.PENDING}),Se.query({query:un,variables:{objectId:t,parentId:n,festId:a,skip:r,limit:s}}).then(function(t){e({type:R.SUCCESS,payload:t.data.getComments,error:""})}).catch(function(t){e({type:R.ERROR,payload:t.message})})}}),pn=n(230),dn=n.n(pn),gn=n(220),fn=n.n(gn),hn=n(221),vn=n.n(hn),yn=n(106),bn=n.n(yn),En=function(e){function t(){return Object(J.a)(this,t),Object(Q.a)(this,Object(Z.a)(t).apply(this,arguments))}return Object(X.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this.props,t=e.date,n=e.i18n,a=e.isComment,s="ru";n&&(s=n.language);var o="ru"===s?bn()(fn.a):bn()(vn.a);return r.a.createElement(dn.a,{date:t,formatter:o,itemProp:a?"commentTime":"datePublished"})}}]),t}(r.a.PureComponent),kn=(n(300),function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).goToUser=function(e){console.log("Go to comment",n.props.comment),console.log("Event data: ",e),n.props.go(e)},n.followUser=function(){},n.unFollowUser=function(){},n.state={},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){var e=this.props.comment,t=e.author.profile.image||"https://cdn.ryfma.com/defaults/icons/default_full_avatar.jpg";return t.indexOf("_full_")>0?t=t.replace("_full_","_medium_"):t.indexOf("graph.facebook.com")>0&&(t=t.replace("=large","=square")),r.a.createElement("div",{className:"comment-item"},r.a.createElement(ne.Cell,{key:e._id,id:e._id,size:"l",description:r.a.createElement(En,{date:e.postedAt,isComment:!0}),before:r.a.createElement(ne.Avatar,{size:36,src:e.author.profile.image})},e.author.profile.name),r.a.createElement(ne.Div,{className:"content"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.content}})))}}]),t}(a.Component)),In=function(e){e.goToFunc;return r.a.createElement(ne.Group,null,r.a.createElement(ne.Cell,null,"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432 \u043f\u043e\u043a\u0430 \u043d\u0435\u0442. \u0411\u0443\u0434\u044c \u043f\u0435\u0440\u0432\u044b\u043c!"))},Pn=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).fetchMoreComments=function(e){e.activeTab,e.replaceFeed,e.skip;return function(){var e=n.props,t=e.objectId,a=e.parentId,r=e.festId,s=e.skip,o=e.limit;n.props.getCommentsFunc({objectId:t,parentId:a,festId:r,skip:s,limit:o})}},n.state={comments:[],activeTab:"latest",lastType:e.type,duration:e.duration},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),console.log("props: ",this.props);var e=this.props,t=e.objectId,n=e.parentId,a=e.festId,r=e.skip,s=e.limit;this.props.getCommentsFunc({objectId:t,parentId:n,festId:a,skip:r,limit:s})}},{key:"render",value:function(){var e=this,t=this.props,n=t.comments,a=t.isPendingComments;return console.log("comments: ",n),a?r.a.createElement(Ye,null):0===n.length?r.a.createElement(ne.Group,null,r.a.createElement(In,null)):r.a.createElement(ne.Group,{className:"comments-list"},r.a.createElement(ne.Div,null,r.a.createElement("h3",null,"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438 (",n.length,")")),r.a.createElement(ne.List,null,n.map(function(t){return r.a.createElement(kn,{key:t._id,comment:t,go:e.props.go})}),this.state.comments.length>0&&r.a.createElement(ne.Div,null,r.a.createElement(ne.Button,{size:"xl",level:"secondary",onClick:this.fetchMoreComments({activeTab:this.state.activeTab,replaceFeed:!1,skip:this.state.comments.length})},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))}}]),t}(a.Component);var Sn=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{comments:e.comments.comments,isPendingComments:e.comments.isPendingComments}},function(e){return Object(i.b)({getCommentsFunc:mn},e)})(Pn),On={wrapperId:"notification-wrapper",animationDuration:300,timeout:5e3,zIndex:1e4,colors:{error:{color:"#FFFFFF",backgroundColor:"#E85742"},success:{color:"#FFFFFF",backgroundColor:"#55CA92"},warning:{color:"#333333",backgroundColor:"#F5E273"},info:{color:"#FFFFFF",backgroundColor:"#4990E2"}}},wn=new(function(){function e(){Object(J.a)(this,e)}return Object(K.a)(e,[{key:"styles",get:function(){return{container:{position:"fixed",width:"30%",margin:"0 auto",right:"0px",top:"-110px",left:"0px",textAlign:"center",zIndex:On.zIndex,pointerEvents:"none",transition:"all "+On.animationDuration+"ms ease",transform:"translateY(0px)",msTransition:"all "+On.animationDuration+"ms ease",msTransform:"translateY(0px)",WebkitTransition:"all "+On.animationDuration+"ms ease",WebkitTransform:"translateY(0px)",OTransition:"all "+On.animationDuration+"ms ease",OTransform:"translateY(0px)",MozTransition:"all "+On.animationDuration+"ms ease",MozTransform:"translateY(0px)"},content:{cursor:"pointer",display:"block",width:"auto",borderRadius:"0 0 4px 4px",backgroundColor:"white",padding:"8px 24px",pointerEvents:"all"},show:{transform:"translateY(108px)",msTransform:"translateY(108px)",WebkitTransform:"translateY(108px)",OTransform:"translateY(108px)",MozTransform:"translateY(108px)"},hide:{transform:"translateY(-108px)",msTransform:"translateY(-108px)",WebkitTransform:"translateY(-108px)",OTransform:"translateY(-108px)",MozTransform:"translateY(-108px)"}}}}]),e}()),Cn=function(e){function t(){var e,n;Object(J.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(Q.a)(this,(e=Object(Z.a)(t)).call.apply(e,[this].concat(r)))).state={containerStyle:wn.styles.container},n.getToastStyle=function(){var e=n.props,t=e.type,a=e.color,r=wn.styles,s={};switch(t){case"success":case"error":case"warning":case"info":s=Object.assign({},r.content,On.colors[t]);break;case"custom":var o={backgroundColor:a.background,color:a.text};s=Object.assign({},r.content,o);break;default:s=Object.assign({},r.content)}return s},n.animateState=function(){var e=wn.styles;setTimeout(function(){n.updateStyle(e.show)},100),-1!==n.props.timeout&&setTimeout(function(){n.updateStyle(e.hide)},n.props.timeout)},n.updateStyle=function(e){var t=wn.styles;n.setState({containerStyle:Object.assign({},t.container,e)})},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){this.animateState()}},{key:"render",value:function(){var e=this.props.text,t=this.state.containerStyle;return r.a.createElement("div",{className:"toast-notification",style:t},r.a.createElement("span",{style:this.getToastStyle()},e))}}]),t}(r.a.PureComponent),Tn=function(e,t,n,a){if(!document.getElementById(On.wrapperId).hasChildNodes()){var s=n||On.timeout;return function(e,t,n,a){var s=document.getElementById(On.wrapperId);o.a.render(r.a.createElement(Cn,{text:e,timeout:n,type:t,color:a}),s)}(e,t,s,a),-1===s?!1:(setTimeout(function(){!function(){var e=document.getElementById(On.wrapperId);o.a.unmountComponentAtNode(e)}()},s+On.animationDuration),!0)}return!1},jn={error:function(e){e.graphQLErrors?Tn(e.graphQLErrors[0].message,"error",1e4):Tn(e,"error",1e4)},success:function(e){Tn(e,"success",3e3)},warning:function(e){Tn(e,"warning",6e3)}},$n=function(e){function t(){return Object(J.a)(this,t),Object(Q.a)(this,Object(Z.a)(t).apply(this,arguments))}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e;e=this.props.options,On=Object.assign(On,e)}},{key:"render",value:function(){return r.a.createElement("div",{id:"notification-wrapper"})}}]),t}(r.a.PureComponent),_n=function(e){e.goToFunc;return r.a.createElement(ne.Group,null,r.a.createElement(ne.Cell,null,"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043f\u043e\u0441\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"))},Un=n(222),Nn=n.n(Un),Rn=n(231),Dn=n.n(Rn),Fn=n(232),xn=n.n(Fn),Ln=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).handleLikePost=nn()(Object(en.a)(Xt.a.mark(function e(){var t,a,r,s,o,i,l,c;return Xt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.currUser){e.next=3;break}return e.abrupt("return");case 3:return t=n.props.post,a=t.title,r=t.userId,s=t._id,o=n.state,i=o.totalLikes,l=o.currUserLikes,c=l>50?50:l,e.prev=6,e.next=9,Ve({_id:s,title:a,userId:r,totalLikes:c,likes:l-i});case 9:an.a.event({category:"Post",action:"PostLiked",value:c}),n.setState(function(e){return{hearts:[],totalLikes:e.likes}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),$n.error(e.t0);case 16:case"end":return e.stop()}},e,this,[[6,13]])})),2e3),n.createLikes=function(){if(n.props.currUser){var e=n.state.hearts||[],t=n.state.currUserLikes;t+=1;var a=Math.floor(100*Math.random()+1),s=(Math.random()*(1.6-1.2)+1.2).toFixed(1);e.push({id:"part-"+a,content:r.a.createElement("div",{key:"part-"+a,className:"heartAnim part-".concat(a),style:{display:"block",fontSize:Math.floor(28*Math.random()+22)+"px",animation:["flowOne","flowTwo","flowThree"][Math.floor(3*Math.random())]+" "+s+"s linear"}},r.a.createElement("i",{"aria-hidden":"true",className:"icon heart ".concat(["colOne","colTwo","colThree","colFour","colFive","colSix"][Math.floor(6*Math.random())])}))}),n.setState({hearts:e,currUserLikes:t}),setTimeout(function(){var t=e.map(function(e){return e.id}).indexOf("part-"+a);e.splice(t,1),n.setState({hearts:e})},900*s)}else $n.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b")},n.setNewLike=function(){var e=n.props.currUser;console.log("Notif: ",$n),e&&n.state.currUserLikes<50&&(n.createLikes(),n.setState({liked:!0,likes:n.state.likes+1}),n.handleLikePost())},n.state={likes:0,liked:!1,hearts:[]},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount PostPage"),console.log("props: ",this.props),this.props.getPostContents({postId:this.props.postId}),window.scrollTo(0,0)}},{key:"render",value:function(){var e=this.props,t=e.postInfo;if(e.isPendingContentsPostInfo)return r.a.createElement(Ye,null);if(!t)return r.a.createElement(_n,null);var n=this.state.likes,a=(t.viewCount,this.state.liked);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ne.Group,null,r.a.createElement(ne.Div,{className:"post-page"},r.a.createElement("h2",null,t.title),r.a.createElement("img",{src:t.coverImg,style:{width:"100%",borderRadius:6}}),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.htmlBody}}),t.tags&&r.a.createElement(ne.List,{className:"post-tags"},t.tags.map(function(e){return r.a.createElement("span",null,r.a.createElement(ne.Link,{to:"/tags/".concat(e._id,"/").concat(e.name)},e.name))})),r.a.createElement("div",{className:"tags-hint"},r.a.createElement("div",null,r.a.createElement("b",null,"\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0441\u0442\u0443 \u043e\u0442 1 \u0434\u043e 50 \u043b\u0430\u0439\u043a\u043e\u0432!"))),r.a.createElement("div",{className:"meta post-footer"},r.a.createElement("div",{className:"post-stat-share"},r.a.createElement("div",{key:0,className:"like-block"},r.a.createElement("div",{className:"post-like-label ui label basic ".concat(a?"liked":""),onClick:this.setNewLike},a?r.a.createElement(xn.a,null):r.a.createElement("div",{className:"like-container"},r.a.createElement(Dn.a,null),r.a.createElement("div",{className:"pulse-ring"})),r.a.createElement("div",{className:"hearts"},this.state.hearts.map(function(e){return e.content}))),r.a.createElement(ne.Link,{to:"/p/".concat(t._id,"/").concat(t.slug,"/likers"),className:"likers-count"},n)),r.a.createElement("div",{key:1,className:"stats-block"},r.a.createElement("a",{href:"#comments",className:"ui label basic post-comment-label"},r.a.createElement(Nn.a,null),r.a.createElement("span",null,t.commentsCount))))),t.author&&r.a.createElement(Tt,{user:t.author,go:this.props.go,isPost:!0,isShortBio:!0}))),r.a.createElement(Sn,{author:t.author,objectType:"post",objectId:t._id,title:t.title,commentsCount:t.commentsCount}))}}]),t}(a.Component);var An=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{postInfo:e.posts.postInfo,isPendingContentsPostInfo:e.posts.isPendingContentsPostInfo}},function(e){return Object(i.b)({getPostContents:We},e)})(Ln),Mn=n(82),Gn=function(e){e.goToFunc;return r.a.createElement(ne.Group,null,r.a.createElement(ne.Cell,null,"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043a\u043e\u043d\u043a\u0443\u0440\u0441 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"))},Bn=(n(146),function(e){function t(e){var n;Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).handleChange=function(e){n.setState({sliderValue:e})},n.handleChangeComplete=nn()(Object(en.a)(Xt.a.mark(function e(){var t,a,r,s,o,i,l;return Xt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.currUserId&&n.props.isJury){e.next=4;break}return jn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b"),e.abrupt("return");case 4:return t=n.props.currentLevel,a=n.props.post,r=a.userId,s=a._id,o=n.state,i=o.sliderValue,l=o.changeRating,e.prev=7,e.next=10,n.props.rateFestPost({festId:n.props.festId,postId:s,userId:r,rating:i,changeRating:i-l,level:t});case 10:an.a.event({category:"Contest",action:"JuryRated",value:i}),n.setState({rating:i,changeRating:i}),jn.success("\u041e\u0446\u0435\u043d\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430!"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),jn.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[7,15]])})),500),n.createLikes=function(){if(n.props.currUserId){var e=n.state.hearts||[],t=n.state.currUserLikes;t+=1;var a=Math.floor(100*Math.random()+1),s=(Math.random()*(1.6-1.2)+1.2).toFixed(1);e.push({id:"part-"+a,content:r.a.createElement("div",{key:"part-"+a,className:"heartAnim part-".concat(a),style:{display:"block",fontSize:Math.floor(28*Math.random()+22)+"px",animation:["flowOne","flowTwo","flowThree"][Math.floor(3*Math.random())]+" "+s+"s linear"}},r.a.createElement("i",{name:"heart",className:"".concat(["colOne","colTwo","colThree","colFour","colFive","colSix"][Math.floor(6*Math.random())])}))}),n.setState({hearts:e,currUserLikes:t}),setTimeout(function(){var t=e.map(function(e){return e.id}).indexOf("part-"+a);e.splice(t,1),n.setState({hearts:e})},900*s)}else jn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b")},n.likePost=nn()(Object(en.a)(Xt.a.mark(function e(){var t,a,r,s,o,i,l,c;return Xt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.props.currUserId){e.next=4;break}return jn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b"),e.abrupt("return");case 4:return t=n.props.post.post,a=t.title,r=t.userId,s=t._id,o=n.state,i=o.totalLikes,l=o.currUserLikes,c=l>50?50:l,e.prev=7,e.next=10,n.props.likePost({_id:s,title:a,userId:r,totalLikes:c,likes:l-i});case 10:an.a.event({category:"Post",action:"PostLiked",value:c}),n.setState({hearts:[],totalLikes:c}),setTimeout(function(){n.setState({hearts:[]})},500),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),jn.error(e.t0);case 18:case"end":return e.stop()}},e,this,[[7,15]])})),2e3),n.setNewLike=function(){n.props.currUserId?n.state.currUserLikes<50&&(n.createLikes(),n.setState({liked:!0,likes:n.state.likes+1}),n.likePost()):jn.error("\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442, \u0447\u0442\u043e\u0431\u044b \u043b\u0430\u0439\u043a\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u044b")},n.handleComments=function(){n.setState({showComments:!0})};var a=e.currUserId,s=n.props.post.juryStats,o=0;if(s)for(var i=0;i<s.length;i++)s[i].userId===a&&(o=s[i].rating);var l=e.post.post,c=l.liked,u=l.currUserLikes;return n.state={showFull:!1,showComments:e.showComments,sliderValue:o,changeRating:o,likes:e.post.likeCount,liked:c,totalLikes:0===u&&c?1:u,currUserLikes:0===u&&c?1:u,hearts:[],isAdultContent:e.post.post.isAdultContent},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=Object(en.a)(Xt.a.mark(function e(){return Xt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.props.post.post._id){e.next=4;break}return e.next=4,this.props.increasePostViewCount({_id:this.props.post.post._id});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}},e,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.post;if(!e.author)return null;var t=e.post.excerpt;return r.a.createElement("div",{id:e._id,className:"post-list-item"},r.a.createElement(ne.Cell,{size:"l",description:"\u043e\u0442 "+e.author.profile.name,before:r.a.createElement(ne.Avatar,{size:36,src:e.author.profile.image}),onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},e.post.title),r.a.createElement(ne.Div,{className:"content",onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},e.coverImg&&r.a.createElement(ne.Avatar,{type:"image",src:e.coverImg,className:"post-image"}),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:t}})),r.a.createElement(ne.Cell,{onClick:this.props.go,"data-view":"postpage","data-panel":"postpage","data-postid":e._id,"data-headertitle":e.title},r.a.createElement(ne.Link,{onClick:this.goToPost},"\u0427\u0438\u0442\u0430\u0442\u044c \u0434\u0430\u043b\u0435\u0435")))}}]),t}(r.a.Component)),qn=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).refetchData=function(){n.setState({refreshing:!0}),n.props.getFestPostsInfo({festId:n.props.festId,keyword:n.props.keyword,sortType:n.props.sortType,filterType:n.props.filterType,city:n.props.citySelected,skip:0,limit:8}).then(function(){n.setState({refreshing:!1})})},n.fetchMorePosts=function(){var e=n.props.contestPosts;n.props.getPosts({festId:n.props.festId,keyword:n.props.keyword,sortType:n.props.sortType,filterType:n.props.filterType,city:n.props.citySelected,skip:e.length,limit:8})},n.state={contestPosts:[]},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),console.log("festPosts: ",this.props),this.props.getFestPostsInfo({festId:this.props.fest._id,keyword:this.props.keyword,sortType:this.props.sortType,filterType:this.props.filterType,city:this.props.citySelected,skip:0,limit:8})}},{key:"render",value:function(){var e=this,t=this.props,n=t.contestPosts,a=t.isPendingLatestPosts;return n?0===n.length?r.a.createElement(Ke,null):r.a.createElement("div",{className:"contest-posts-wrapper"},r.a.createElement("h2",null,"\u0421\u0442\u0438\u0445\u0438 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"),r.a.createElement("div",{className:"ui segment user-posts"},r.a.createElement("h3",null,"\u041d\u0435 \u0441\u0442\u0435\u0441\u043d\u044f\u0439\u0442\u0435\u0441\u044c \u043e\u0431\u0441\u0443\u0436\u0434\u0430\u0442\u044c \u0438 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0442\u044c \u043b\u0430\u0439\u043a\u0430\u043c\u0438 (\u043e\u0442 0 \u0434\u043e 50) \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u044f"),r.a.createElement(ne.List,null,n.map(function(t){return r.a.createElement(Bn,{key:t._id,post:t,go:e.props.go})}),a&&r.a.createElement(Ye,null),r.a.createElement(ne.Div,null,r.a.createElement(ne.Button,{size:"xl",level:"secondary",onClick:this.fetchMorePosts},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"))))):r.a.createElement(Ke,null)}}]),t}(a.Component);var zn=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{contestPosts:e.contests.contestPosts,isPendingContestPosts:e.contests.isPendingContestPosts}},function(e){return Object(i.b)({getFestPostsInfo:Wt},e)})(qn),Vn=n(233),Hn=n.n(Vn),Wn=n(234),Yn=n.n(Wn),Jn=Hn()();Jn.tlds(Yn.a);var Kn=function(e){var t=e,n=t.match(/<a\b[^>]*>(.*?)<\/a>/gi);n&&n.map(function(e){var n=e.match(/<a [^>]+>([^<]+)<\/a>/i);n&&(t=t.replace(e,n[1]))});var a=(t=function(e){var t=e,n=Jn.match(e);return n&&n.map(function(e){t=e.url.includes("ryfma.com")?t.replace(e.url,"<a href='".concat(e.url,"' class='away-link'>").concat(e.url,"</a>")):t.replace(e.url,"<a href='".concat(e.url,"' class='away-link' rel='nofollow noopener' target='_blank'>").concat(e.url,"</a>"))}),t}(t)).match(/\B[@\uff20][a-z0-9_-]+/gi);return a&&(t=a.map(function(e){return t.replace(e,"<a href='/u/".concat(e.replace("@","").replace("\uff20",""),"' class='mention-link' target='_blank'>").concat(e,"</a>"))})),t},Qn=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).changeSort=function(e){return function(t){n.setState({sortType:e})}},n.handleDesc=function(){n.setState({showDesc:!n.state.showDesc})},n.levelDone=function(e){return Object(en.a)(Xt.a.mark(function t(){var a,r,s,o;return Xt.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.state,r=a.minJuryRating,s=a.amountOfPosts,o={_id:n.props.contest._id,levelDone:e,minJuryRating:r,amountOfPosts:s},t.prev=2,t.next=5,n.props.updateContestLevel(o);case 5:Notification.success(n.props.t("common:notif.contestUpdated")),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(2),Notification.error(t.t0);case 11:case"end":return t.stop()}},t,this,[[2,8]])}))},n.handleInputChange=function(e){var t=e.target,a=t.value,r=t.name;n.setState(Object(Mn.a)({},r,a))},n.state={fetchedUser:e.fetchedUser,sortType:"jury",showDesc:!1,minJuryRating:0,amountOfPosts:0},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount PostPage"),this.props.getContestInfo({slug:this.props.contestSlug,festId:this.props.contestId})}},{key:"render",value:function(){var e=this,t=this.props,n=t.contest;if(t.isPendingContest)return r.a.createElement(Ye,null);if(!n)return r.a.createElement(Gn,null);var a=this.state,s=a.sortType,o=(a.minJuryRating,a.amountOfPosts,a.fetchedUser),i=n;i.isFestival;var l=i.currentLevel||1,c=l,u=new Date,m=(new Date(i.fromDate),new Date(i.toDate)),p=o?o._id:null,d=o,g=(i.juryData?i.juryData.map(function(e){return e._id}):[]).includes(p),f=i.description||"",h=f.split("\n"),v=0,y=[],b=[];h.map(function(e,t){v<412?e?(v+=e.length,y.push(r.a.createElement("p",{key:t,dangerouslySetInnerHTML:{__html:"".concat(Kn(e))}}))):y.push(r.a.createElement("br",{key:t})):e?b.push(r.a.createElement("p",{key:t,dangerouslySetInnerHTML:{__html:"".concat(Kn(e))}})):b.push(r.a.createElement("br",{key:t}))});var E=[];if(i.levels>1){for(var k=1;k<i.levels;k++)E.push(r.a.createElement(ne.TabsItem,{className:c===k?"level item active":"level item"},"\u042d\u0442\u0430\u043f ",k," ",k<l?"(\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d)":""," ",k===l?"\u0422\u0435\u043a\u0443\u0449\u0438\u0439":""));E.push(r.a.createElement(ne.TabsItem,{className:c===i.levels?"level item active":"level item"},"\u0424\u0438\u043d\u0430\u043b"))}var I=c===i.levels;return r.a.createElement(ne.Group,{id:n._id},r.a.createElement(ne.Div,{className:"fest-page"},i.coverImg&&r.a.createElement("div",{className:"ui image"},r.a.createElement("img",{className:"contest-banner",itemProp:"image",src:i.coverImg,alt:i.genres?i.title+". "+i.genres.map(function(e){return e}).join(","):i.title})),u>m&&r.a.createElement("div",{className:"winners ".concat(s)},r.a.createElement("h1",null,"\u041f\u043e\u0431\u0435\u0434\u0438\u0442\u0435\u043b\u0438"),r.a.createElement(ne.Tabs,{type:"buttons"},r.a.createElement(ne.TabsItem,{onClick:function(){return e.setState({sortType:"jury"})},selected:"jury"===this.state.sortType},"\u0412\u044b\u0431\u043e\u0440 \u0436\u044e\u0440\u0438"),r.a.createElement(ne.TabsItem,{onClick:function(){return e.setState({sortType:"likes"})},selected:"likes"===this.state.sortType},"\u0412\u044b\u0431\u043e\u0440 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"))),r.a.createElement(ne.Tabs,{type:"buttons"},r.a.createElement(ne.TabsItem,{selected:!0},"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),r.a.createElement(ne.TabsItem,null,"\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432")),r.a.createElement("h1",{itemProp:"name"},i.title),r.a.createElement("div",{className:"contest-body"},f.length>412?r.a.createElement("div",{className:"fest-desc"},r.a.createElement("div",{className:"slide-down",itemProp:"description"},y,!this.state.showDesc&&r.a.createElement("div",{className:"slide-fade"})),r.a.createElement("div",{className:this.state.showDesc?"slide-down-hidden open":"slide-down-hidden",itemProp:"description"},b),r.a.createElement("div",{className:"slide-down-button",onClick:this.handleDesc},this.state.showDesc?"\u0421\u043a\u0440\u044b\u0442\u044c":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0441\u0442\u044c\u044e")):r.a.createElement("span",{itemProp:"description"},y)),i.partners&&r.a.createElement("div",{className:"partners"},r.a.createElement("h3",null,"\u041f\u0440\u0438\u0437\u044b \u043e\u0442 \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432"),r.a.createElement("div",{className:"partner-name"},i.partners[0].logoLink.includes("<svg")?r.a.createElement("div",{className:"partner-logo",dangerouslySetInnerHTML:{__html:i.partners[0].logoLink}}):r.a.createElement("img",{src:i.partners[0].logoLink,className:"partner-logo"}),r.a.createElement("h4",null,i.partners[0].name)),r.a.createElement("div",{className:"partner-brief",dangerouslySetInnerHTML:{__html:i.partners[0].brief}}),r.a.createElement("div",{className:"partner-images"},r.a.createElement("div",{className:"partner-image"},r.a.createElement("img",{src:i.partners[0].images[0]})),r.a.createElement("div",{className:"partner-image"},r.a.createElement("img",{src:i.partners[0].images[1]})),r.a.createElement("div",{className:"partner-image"},r.a.createElement("img",{src:i.partners[0].images[2]}))),r.a.createElement("a",{href:"".concat(i.partners[0].url,"?utm_source=ryfma&utm_medium=contest&utm_campaign=partner"),target:"_blank",rel:"noopener nofollow",className:"ui button partner-more"},"\u0411\u043e\u043b\u044c\u0448\u0435 \u043f\u0440\u0438\u0437\u043e\u0432")),E.length>0&&r.a.createElement(ne.Tabs,{type:"buttons",className:"level-filters"},E),r.a.createElement(zn,{fest:i,currentLevel:c,isMultiLevel:E.length>1,isFinal:I,isJury:g,juryId:p,currUser:d,go:this.props.go})))}}]),t}(a.Component);var Zn=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{contest:e.contests.contestInfo,isPendingContest:e.contests.isPendingContest}},function(e){return Object(i.b)({getContestInfo:Vt},e)})(Qn),Xn=function(e){e.goToFunc;return r.a.createElement(ne.Group,null,r.a.createElement(ne.Cell,null,"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"))},ea=n(235),ta=n.n(ea),na=n(236),aa=n.n(na),ra=n(237),sa=n.n(ra),oa=n(238),ia=n.n(oa),la=n(239),ca=n.n(la),ua=n(240),ma=n.n(ua),pa=n(241),da=n.n(pa),ga=n(242),fa=n.n(ga),ha=n(243),va=n.n(ha),ya=n(107),ba=n.n(ya),Ea=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).handleDesc=function(){n.setState({showDesc:!n.state.showDesc})},n.state={showBio:!1,activeTab:"latest"},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount UserPage"),console.log("props: ",this.props),this.props.getUserInfo({username:this.props.username}),window.scrollTo(0,0)}},{key:"render",value:function(){var e=this.props,t=e.user;if(e.isPendingUser)return r.a.createElement(Ye,null);if(!t)return r.a.createElement(Xn,null);if(!t.profile)return r.a.createElement(Xn,null);var n=[t.profile.vkUser,t.profile.instagramUser,t.profile.twitterUser,t.profile.facebookUser].map(function(e){if(e)return e.replace("https://","").replace("http://","").replace("www.","")}),a=(t.profile.bio||"").split("\n"),s=0,o=[],i=[];return a.map(function(e,t){s<80?e&&(s+=e.length,o.push(r.a.createElement("span",{key:t,dangerouslySetInnerHTML:{__html:"".concat(Kn(e))}}))):e&&i.push(r.a.createElement("span",{key:t,dangerouslySetInnerHTML:{__html:"".concat(Kn(e))}}))}),r.a.createElement("div",null,r.a.createElement(ne.Group,null,r.a.createElement(ne.Div,{className:"user-page"},r.a.createElement(ne.Avatar,{size:130,src:t.profile.image}),r.a.createElement("div",{className:"content"},r.a.createElement("h1",null,t.profile.name,t.emails?t.emails[0].verified&&r.a.createElement(ta.a,null):null),r.a.createElement("div",{className:"karma"},r.a.createElement(aa.a,{fill:"red"}),t.profile.karma.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),"\xa0\u041a\u0430\u0440\u043c\u0430"),(t.profile.city||t.profile.website)&&r.a.createElement("div",{className:"website-city"},t.profile.website&&r.a.createElement("div",{className:"user-website"},r.a.createElement(an.a.OutboundLink,{eventLabel:"Go to User website",to:"http://".concat(t.profile.website.replace("https://","").replace("http://","")),target:"_blank",rel:"noopener nofollow",className:"item",role:"listitem",itemProp:"url"},r.a.createElement(sa.a,null),function(e){var t=function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]}(e),n=t.split("."),a=n.length;return a>2&&(t=n[a-2]+"."+n[a-1],2===n[a-1].length&&2===n[a-1].length&&(t=n[a-3]+"."+t)),t}(t.profile.website.replace("https://","").replace("http://","")))),t.profile.city&&r.a.createElement("div",{className:"user-city"},r.a.createElement(ia.a,null),t.profile.city)),n.length&&r.a.createElement("div",{className:"meta"},r.a.createElement("div",{className:"ui list link horizontal"},t.profile.vkUser?r.a.createElement(an.a.OutboundLink,{eventLabel:"Go to User VK",to:"https://vk.com/".concat(n[0].replace("vk.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item vk",itemProp:"sameAs"},r.a.createElement(ca.a,null)):null,t.profile.instagramUser?r.a.createElement(an.a.OutboundLink,{eventLabel:"Go to User Instagram",to:"https://instagram.com/".concat(n[1].replace("instagram.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item in",itemProp:"sameAs"},r.a.createElement(ma.a,null)):null,t.profile.twitterUser?r.a.createElement(an.a.OutboundLink,{eventLabel:"Go to User Twitter",to:"https://twitter.com/".concat(n[2].replace("twitter.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item tw",itemProp:"sameAs"},r.a.createElement(da.a,null)):null,t.profile.facebookUser?r.a.createElement(an.a.OutboundLink,{eventLabel:"Go to User Facebook",to:"https://facebook.com/".concat(n[3].replace("facebook.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item fb",itemProp:"sameAs"},r.a.createElement(fa.a,null)):null,t.profile.youtubeUser?r.a.createElement(an.a.OutboundLink,{eventLabel:"Go to User Youtube",to:"https://youtube.com/".concat(n[4].replace("youtube.com/","")),target:"_blank",rel:"noopener nofollow",role:"listitem",className:"item youtube",itemProp:"sameAs"},r.a.createElement(va.a,null)):null)),r.a.createElement(ne.HorizontalScroll,{className:"user-stats"},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.postsCount||0),"\u041f\u043e\u0441\u0442\u043e\u0432"),r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.albumsCount||0),"\u0410\u043b\u044c\u0431\u043e\u043c\u043e\u0432"),r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.booksCount||0),"\u041a\u043d\u0438\u0433"),r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.followersCount||0),"\u0427\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"),r.a.createElement("div",{className:"item"},r.a.createElement("b",null,t.stats.followingCount||0),"\u0427\u0438\u0442\u0430\u0435\u043c\u044b\u0445"))),t.profile.bio&&r.a.createElement("div",{className:"extra"},t.profile.bio.length>80?r.a.createElement("div",{className:"user-bio"},r.a.createElement("div",{className:"slide-down",itemProp:"description"},o,!this.state.showDesc&&r.a.createElement("div",{className:"slide-fade"})),r.a.createElement("div",{className:this.state.showDesc?"slide-down-hidden open":"slide-down-hidden",itemProp:"description"},i),r.a.createElement("div",{className:"slide-down-button",onClick:this.handleDesc},(this.state.showDesc,r.a.createElement(ba.a,null)))):r.a.createElement("span",{itemProp:"description"},o))))),r.a.createElement(Ze,{type:this.state.activeTab,shortPost:this.props.shortPost,hideAds:!0,userId:t._id,currUser:this.props.currUser,limit:this.props.limit,keyword:this.state.keyword,go:this.props.go,personal:!0,replaceFeed:this.props.replaceFeed}))}}]),t}(a.Component);var ka=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{user:e.users.user,isPendingUser:e.users.isPendingUser}},function(e){return Object(i.b)({getUserInfo:wt},e)})(Ea);function Ia(){var e=Object(Oe.a)(["\n  mutation deleteTag($_id: ID!) {\n    deleteTag(\n      _id: $_id\n    ){\n      _id\n    }\n  }\n"]);return Ia=function(){return e},e}function Pa(){var e=Object(Oe.a)(["\n  mutation insertTag(\n    $name: String!,\n    $slug: String!,\n  ) {\n    insertTag(\n      name: $name,\n      slug: $slug,\n    ){\n      _id\n    }\n  }\n"]);return Pa=function(){return e},e}function Sa(){var e=Object(Oe.a)(["\n  query getPopularTags($limit: Int) {\n    popularTags(limit: $limit)\n  }\n"]);return Sa=function(){return e},e}var Oa=Ce()(Sa()),wa=(Ce()(Pa()),Ce()(Ia()),function(e){var t=e.limit;return function(e,n){return e({type:M.PENDING}),Se.query({query:Oa,variables:{limit:t}}).then(function(t){e({type:M.SUCCESS,payload:t.data.popularTags,error:""})}).catch(function(t){e({type:M.ERROR,payload:t.message})})}}),Ca=(n(308),function(e){function t(){return Object(J.a)(this,t),Object(Q.a)(this,Object(Z.a)(t).apply(this,arguments))}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){this.props.getPopularTagsFunc({limit:20})}},{key:"render",value:function(){var e=this,t=this.props,n=t.popularTags,a=t.isPendingPopularTags,s=[];return n.length>0&&(s=n.map(function(t){if("Pqay8ZqcpBAXrxjGP"===t._id||"Wtd8LFGZRivNu3Dii"===t._id||"m8ddReksPMkG2sTAq"===t._id)return null;var n=t.name;return"uR29TLgWrvEJRv2PX"===t._id?n="\u0421\u0442\u0438\u0445\u0438 \u043e \u0436\u0438\u0437\u043d\u0438":"Pqay8ZqcpBAXrxjGP"===t._id?n="\u0421\u0442\u0438\u0445\u0438 \u043e \u043b\u044e\u0431\u0432\u0438":"ZnDTJawrfgKXGhTE9"===t._id?n="\u041b\u0438\u0440\u0438\u043a\u0430":"FAG88rmdWg5Jmvd5Y"===t._id?n="\u0421\u0442\u0438\u0445\u0438 \u043e \u0432\u043e\u0439\u043d\u0435":"Tou7gKQG9zYjZ3pEC"===t._id?n="\u041b\u044e\u0431\u043e\u0432\u043d\u0430\u044f \u043b\u0438\u0440\u0438\u043a\u0430":"Ka4y3Tg8Gk26qfzsw"===t._id?n="\u0421\u0442\u0438\u0445\u0438 \u043b\u044e\u0431\u0438\u043c\u043e\u043c\u0443":"S6Qjou3daD4HtSAJw"===t._id?n="\u0427\u0443\u0432\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u0441\u0442\u0438\u0445\u0438":"6CYGe5HrqT72ixHeE"===t._id?n="\u0421\u0442\u0438\u0445\u0438 \u043e \u0436\u0435\u043d\u0449\u0438\u043d\u0435":"J4xMSfKe5kZyYK2NL"===t._id&&(n="\u0421\u0442\u0438\u0445\u0438 \u043e \u0434\u0443\u0448\u0435"),r.a.createElement("div",{key:t._id,className:"tag-item",onClick:e.props.go,"data-view":"tagspage","data-panel":"tagspage","data-tagid":t._id,"data-tagname":t.name,"data-headertitle":t.name},r.a.createElement("div",{className:"tag-image"},r.a.createElement("img",{src:t.coverImg})),r.a.createElement("div",{className:"tag-name"},n.replace("#","")))})),r.a.createElement(ne.Group,{className:"popular-tags",style:{paddingBottom:8}},r.a.createElement(ne.Header,{level:"2"},"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u0442\u0435\u0433\u0438"),r.a.createElement(ne.HorizontalScroll,null,a&&r.a.createElement(Ye,null),!a&&0===n.length,!a&&r.a.createElement("div",{style:{display:"flex"}},s,r.a.createElement("div",{key:0,className:"tag-item"},r.a.createElement("div",{className:"tag-name",style:{margin:"8px 16px"}},r.a.createElement("h3",null,"\u0411\u043e\u043b\u044c\u0448\u0435"))))))}}]),t}(r.a.Component));var Ta=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{popularTags:e.tags.popularTags,isPendingPopularTags:e.tags.isPendingPopularTags}},function(e){return Object(i.b)({getPopularTagsFunc:wa},e)})(Ca),ja=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).goToUser=function(e){console.log("Go to user",n.props.user),console.log("Event data: ",e),n.props.go(e)},n.state={keyword:"",activeTab:"users",searchResult:[]},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){console.log("componentWillMount"),this.props.getPaidUsers({})}},{key:"render",value:function(){var e=this,t=this.props,n=t.paidUsers,a=t.isPendingPaidUsers,s={flexShrink:0,width:80,height:120,display:"flex",flexDirection:"column",alignItems:"center",fontSize:12,textAlign:"center"};return r.a.createElement(ne.Group,{style:{paddingBottom:8}},r.a.createElement(ne.Header,{level:"2"},"\u041f\u0440\u0435\u043c\u0438\u0443\u043c \u0430\u0432\u0442\u043e\u0440\u044b"),r.a.createElement(ne.HorizontalScroll,null,r.a.createElement("div",{style:{display:"flex"},className:"paid-users"},a&&r.a.createElement(Ye,null),!a&&n.map(function(t){return r.a.createElement("div",{style:Object(m.a)({},s,{paddingLeft:4}),onClick:e.goToUser,"data-view":"userpage","data-panel":"userpage","data-userid":t._id,"data-username":t.username,"data-headertitle":t.profile.name},r.a.createElement(ne.Avatar,{src:t.profile.image,size:64,style:{marginBottom:8},className:"medium-avatar"},r.a.createElement($t.a,{fill:"#FFFFFF",size:14})),t.profile.name)}))))}}]),t}(a.Component);var $a=Object(l.b)(function(e){return console.log("mapStateToProps"),console.log(e),{paidUsers:e.users.paidUsers,isPendingPaidUsers:e.users.isPendingPaidUsers}},function(e){return Object(i.b)({getPaidUsers:Ct},e)})(ja),_a=function(e){function t(e){var n;return Object(J.a)(this,t),(n=Object(Q.a)(this,Object(Z.a)(t).call(this,e))).getUserInfo=function(){te.a.subscribe(function(e){switch(e.detail.type){case"VKWebAppGetUserInfoResult":n._isMounted&&n.setState({fetchedUser:e.detail.data,activeTab:"myfeed"});break;case"VKWebAppGetUserInfoFailed":n._isMounted&&n.setState({userInfoDenied:!0,activeTab:"latest"});break;default:n.setState({activeTab:"latest"})}}),te.a.send("VKWebAppGetUserInfo",{})},n.getTheme=function(){te.a.subscribe(function(e){switch(e.detail.type){case"VKWebAppUpdateConfig":var t=document.createAttribute("scheme");t.value=e.detail.data.scheme?e.detail.data.scheme:"client_light",document.body.attributes.setNamedItem(t)}})},n.go=function(e){var t=e.currentTarget.dataset,a=t.view,r=t.panel,s=t.postid,o=t.contestid,i=t.contestslug,l=t.userid,c=t.username,u=t.tagid,p=t.tagname,d=t.headertitle,g=n.state,f=g.activeStory,h=g.activeView,v=g.activeTab,y=g.activePanel;console.log("New params: ",e.currentTarget.dataset);var b={activeStory:"modalPages",activeTab:null,returnStory:"modalPages"===f?"modalPages":"epicPages",returnView:h,returnPanel:y,returnTab:v};r&&(b=Object(m.a)({},b,{activePanel:r})),a&&(b=Object(m.a)({},b,{activeView:a})),s&&(b=Object(m.a)({},b,{postId:s})),o&&(b=Object(m.a)({},b,{contestId:o,contestSlug:i})),l&&(b=Object(m.a)({},b,{userId:l,username:c})),u&&(b=Object(m.a)({},b,{tagId:u,tagName:p})),d&&(b=Object(m.a)({},b,{headerModalTitle:d})),n.setState(b)},n.returnTo=function(){var e=n.state,t=e.returnStory,a=e.returnView,r=e.returnPanel,s=e.returnTab;console.log("returnTo: ",n.state),n.setState({activeStory:t||"epicPages",activeView:a||"feed",activePanel:r||"feed",activeTab:s||"latest",returnStory:null,returnView:null,returnPanel:null,returnTab:null})},n.onStoryChange=function(e){return function(t){var a=t.currentTarget.dataset,r=a.story,s=a.epictab;console.log("story change",t.currentTarget.dataset),"epicPages"===r?n.setState({activeStory:r,epicTab:s,activeView:e,activeTab:"latest"}):n.setState({activeStory:r,epicTab:s,activeView:e})}},n.state={activeStory:"epicPages",activeView:"feed",activePanel:"feed",activeTab:"latest",epicTab:"feed",username:"polina",headerModalTitle:"\u041f\u043e\u043b\u0438\u043d\u0430 (Pola) \u0428\u0438\u0431\u0435\u0435\u0432\u0430",popularTab:"day",fetchedUser:null,userInfoDenied:!1},n}return Object(X.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){ae.clear(),this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.state,n=t.fetchedUser;t.userInfoDenied;console.log("state: ",this.state);var a=Object(ne.platform)();return r.a.createElement(ne.Epic,{activeStory:this.state.activeStory,tabbar:r.a.createElement(ne.Tabbar,null,r.a.createElement(ne.TabbarItem,{onClick:this.onStoryChange("feed"),selected:"feed"===this.state.epicTab,"data-story":"epicPages","data-epictab":"feed"},r.a.createElement(ce.a,null)),r.a.createElement(ne.TabbarItem,{onClick:this.onStoryChange("search"),selected:"search"===this.state.epicTab,"data-story":"epicPages","data-epictab":"search"},r.a.createElement(me.a,null)),r.a.createElement(ne.TabbarItem,{onClick:this.onStoryChange("contests"),selected:"contests"===this.state.epicTab,"data-story":"epicPages","data-epictab":"contests"},r.a.createElement(de.a,null)))},r.a.createElement(ne.Root,{id:"epicPages",activeView:this.state.activeView},r.a.createElement(ne.View,{id:"feed",activePanel:"feed"},r.a.createElement(ne.Panel,{id:"feed"},r.a.createElement(ne.PanelHeader,{noShadow:!0,left:r.a.createElement(ne.HeaderButton,null),right:r.a.createElement(ne.HeaderButton,null)},"\u041b\u0435\u043d\u0442\u0430 \u043f\u043e\u0441\u0442\u043e\u0432"),r.a.createElement(ne.FixedLayout,{vertical:"top"},r.a.createElement(ne.Tabs,{theme:"header",type:"buttons"},r.a.createElement(ne.HorizontalScroll,null,this.state.fetchedUser&&r.a.createElement(ne.TabsItem,{onClick:function(){return e.setState({activeTab:"myfeed"})},selected:"myfeed"===this.state.activeTab},"\u041c\u043e\u044f \u043b\u0435\u043d\u0442\u0430"),r.a.createElement(ne.TabsItem,{onClick:function(){return e.setState({activeTab:"latest"})},selected:"latest"===this.state.activeTab},"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0435\u0435"),r.a.createElement(ne.TabsItem,{onClick:function(){return e.setState({activeTab:"popular"})},selected:"popular"===this.state.activeTab},"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0435")))),this.state.fetchedUser&&"myfeed"===this.state.activeTab&&r.a.createElement(ne.Root,{activeView:"latest"},r.a.createElement(ne.View,{id:"latest",activePanel:"latest"},r.a.createElement(ne.Panel,{id:"latest"},r.a.createElement(Ze,{go:this.go,type:"myfeed",personal:!0})))),"latest"===this.state.activeTab&&r.a.createElement(ne.Root,{activeView:"latest"},r.a.createElement(ne.View,{id:"latest",activePanel:"latest"},r.a.createElement(ne.Panel,{id:"latest"},r.a.createElement($a,{go:this.go}),r.a.createElement(Ta,{go:this.go}),r.a.createElement(Ze,{go:this.go,type:"latest",replaceFeed:!0,withImage:!0})))),"popular"===this.state.activeTab&&r.a.createElement(ne.Root,{activeView:"latest"},r.a.createElement(ne.View,{id:"latest",activePanel:"latest"},r.a.createElement(ne.Panel,{id:"latest"},r.a.createElement(Ze,{go:this.go,type:"popular",replaceFeed:!0,duration:this.state.popularTab})))))),r.a.createElement(ne.View,{id:"search",activePanel:"search"},r.a.createElement(ne.Panel,{id:"search"},r.a.createElement(ne.PanelHeader,{noShadow:!0},"\u041f\u043e\u0438\u0441\u043a"),r.a.createElement(Lt,{go:this.go}))),r.a.createElement(ne.View,{id:"contests",activePanel:"contests"},r.a.createElement(ne.Panel,{id:"contests"},r.a.createElement(ne.PanelHeader,null,"\u041a\u043e\u043d\u043a\u0443\u0440\u0441\u044b"),r.a.createElement(Qt,{go:this.go}))),r.a.createElement(ne.View,{id:"user",activePanel:"user"},r.a.createElement(ne.Panel,{id:"user"},r.a.createElement(ne.PanelHeader,null,"\u0418\u0432\u0430\u043d \u0418\u0432\u0430\u043d\u043e\u0432")))),r.a.createElement(ne.Root,{id:"modalPages",activeView:this.state.activeView},r.a.createElement(ne.View,{id:"postpage",activePanel:this.state.activePanel},r.a.createElement(ne.Panel,{id:"postpage"},r.a.createElement(ne.PanelHeader,{left:r.a.createElement(ne.HeaderButton,{onClick:this.returnTo},a===ne.IOS?r.a.createElement(se.a,null):r.a.createElement(ie.a,null)),addon:r.a.createElement(ne.HeaderButton,{onClick:this.returnTo},"\u041d\u0430\u0437\u0430\u0434")},this.state.headerModalTitle),r.a.createElement(An,{fetchedUser:n,postId:this.state.postId,go:this.go}))),r.a.createElement(ne.View,{id:"contestpage",activePanel:this.state.activePanel},r.a.createElement(ne.Panel,{id:"contestpage"},r.a.createElement(ne.PanelHeader,{left:r.a.createElement(ne.HeaderButton,{onClick:this.returnTo},a===ne.IOS?r.a.createElement(se.a,null):r.a.createElement(ie.a,null)),addon:r.a.createElement(ne.HeaderButton,{onClick:this.returnTo},"\u041d\u0430\u0437\u0430\u0434")},this.state.headerModalTitle),r.a.createElement(Zn,{fetchedUser:n,contestSlug:this.state.contestSlug,contestId:this.state.contestId,go:this.go}))),r.a.createElement(ne.View,{id:"userpage",activePanel:this.state.activePanel},r.a.createElement(ne.Panel,{id:"userpage"},r.a.createElement(ne.PanelHeader,{left:r.a.createElement(ne.HeaderButton,{onClick:this.returnTo},a===ne.IOS?r.a.createElement(se.a,null):r.a.createElement(ie.a,null)),addon:r.a.createElement(ne.HeaderButton,{onClick:this.returnTo},"\u041d\u0430\u0437\u0430\u0434")},this.state.headerModalTitle),r.a.createElement(ka,{fetchedUser:n,username:this.state.username,userId:this.state.userId,go:this.go,replaceFeed:!0}))),r.a.createElement(ne.View,{id:"tagspage",activePanel:this.state.activePanel},r.a.createElement(ne.Panel,{id:"tagspage"},r.a.createElement(ne.PanelHeader,{left:r.a.createElement(ne.HeaderButton,{onClick:this.returnTo},a===ne.IOS?r.a.createElement(se.a,null):r.a.createElement(ie.a,null)),addon:r.a.createElement(ne.HeaderButton,{onClick:this.returnTo},"\u041d\u0430\u0437\u0430\u0434")},this.state.headerModalTitle),r.a.createElement(Ze,{go:this.go,replaceFeed:!0,tagId:this.state.tagId,subTitle:"\u0421\u0442\u0438\u0445\u0438 \u043f\u043e \u0442\u0435\u0433\u0443 "+this.state.tagName})))))}}]),t}(r.a.Component);te.a.send("VKWebAppInit",{});var Ua=Object(i.d)(H,Object(i.a)(c.a));o.a.render(r.a.createElement(l.a,{store:Ua},r.a.createElement(_a,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/ryfmaVKApp",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/ryfmaVKApp","/service-worker.js");Y?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):W(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):W(e)})}}()}},[[156,2,1]]]);
//# sourceMappingURL=main.974c7b9c.chunk.js.map